(()=>{"use strict";var e={};function t(e,t){let o=document.createElement("div");o.className="productCard",o.dataset.productId=e.id,o.innerHTML=`<div class="productCard__imgContainer">\n      <img class="productCard__img" src="${e.image}" alt="image">\n    </div>\n    <div class="productCard__info">\n      <h3 class="productCard__title">${e.title}</h3>\n      <p class="productCard__category">${e.category}</p>\n      <p class="productCard__price">${e.price}</p>\n    </div>`,t.appendChild(o)}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var o=e.g.document;if(!t&&o&&(o.currentScript&&"SCRIPT"===o.currentScript.tagName.toUpperCase()&&(t=o.currentScript.src),!t)){var r=o.getElementsByTagName("script");if(r.length)for(var n=r.length-1;n>-1&&(!t||!/^http(s?):/.test(t));)t=r[n--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const o=document.getElementById("product-list");let r=[],n="";function a(e,a){let c;o.innerHTML="",n=a,c=""!==a?r.filter((t=>t[e]===a)):r,c.forEach((e=>t(e,o)))}const c=e.p+"7d7081bd4e58ad8aeeed.svg",l=e.p+"7d7081bd4e58ad8aeeed.svg",i=e.p+"57fb51bd3c0d216f8d77.svg",d=e.p+"bfe9ee3da5d9adca399a.svg",s=e.p+"986b24e86270651ca1ba.svg",p=document.getElementById("loadMoreProducts"),u=document.getElementById("deleteProduct"),g=document.getElementById("addProduct"),m={title:"test product",price:13.5,description:"lorem ipsum set",image:"https://i.pravatar.cc",category:"electronic"};!function(){const e=document.createElement("header"),t=document.createElement("div"),o=document.createElement("div"),r=document.createElement("nav"),n=document.createElement("div"),a=document.getElementsByTagName("body")[0];e.setAttribute("id","header"),e.className="header",t.className="header__contentWrapper",o.className="header__logo",o.innerHTML=`<img src="${c}" alt="logo">`,r.className="header__nav",r.innerHTML="<ul>\n          <li>Home</li>\n          <li>Shop</li>\n          <li>Our Story</li>\n          <li>Blog</li>\n          <li>Contact Us</li>\n        </ul>",n.className="header__menu",n.innerHTML="Menu items",t.append(o,r,n),e.appendChild(t),a.prepend(e)}(),async function(){try{let e=await async function(){let e="https://fakestoreapi.com/products";isNaN(6)||(e+="?limit=6");try{console.log("Sending fetch request");let t=await fetch(e);if(!t.ok)throw new Error("Network error");console.log("loading data");let o=await t.json();return console.log(o),o}catch(e){console.log("Error loading products",e)}}();console.log(e),e.forEach((e=>{t(e,o),r.push(e)})),async function(e){let t=document.createElement("div");t.className="productList__categories",t.setAttribute("id","productList__categories"),async function(){try{console.log("Sending fetch request for load categories");let e=await fetch("https://fakestoreapi.com/products/categories");if(!e.ok)throw new Error("Network error");console.log("Loading categories names");let t=await e.json();return console.log(t),t}catch(e){console.log("Error loading categories ",e)}}().then((e=>function(e,t){let o='<option value="">--Show all products--</option>';e.forEach((e=>{o+=`<option value="${e}">\n        ${e}\n      </option>`}));let r=`<label for="productList__select">\n      Show products filtered by category:\n    </label>\n    <select name="productList__select" id="productList__select">\n      ${o};\n    </select>`;t.innerHTML=r}(e,t))),e.parentNode.prepend(t),t.addEventListener("change",(e=>a("category",e.target.value)))}(o)}catch(e){console.log("error loading data from API",e)}}(),function(){const e=document.getElementsByTagName("body")[0],t=document.createElement("footer"),o=document.createElement("div"),r=document.createElement("div"),n=document.createElement("div"),a=document.createElement("address");document.createElement("div"),document.createElement("div"),document.createElement("div"),a.className="footer__address",a.innerHTML=`\n    <p>\n      <img src=${l} alt="Logo" class="footer__logo">\n    </p>\n    <p>\n      <img src=${d} alt="phone" width=24 height=24>\n      <a href="tel:+1 7045550127">(704) 555-0127</a>\n    </p>\n    <p>\n      <img src=${i} alt="mail" width=24 height=24>\n      <a href="mailto:krist@example.com">krist@example.com</a>\n    </p>\n    <p>\n      <img src=${s} alt="address" width=24 height=24>\n      <span>3891 Ranch</span>\n    </p>`,r.append(a),t.setAttribute("id","footer"),t.className="footer",o.className="footer__wrapper",o.append(r,n),t.append(o),e.append(t)}(),console.log("loaded from index.js"),console.log("index.js code runs. Dev server and auto reload works"),p.addEventListener("click",(e=>{(function(e){if(console.log("load more products called"),r.length>=20)return;const t=Math.min(6,20-r.length);let o=new Array(t).fill().map(((e,t)=>r.length+t+1));Promise.allSettled(o.map((e=>async function(e){let t=`https://fakestoreapi.com/products/${e}`;try{console.log("Sending fetch request");let e=await fetch(t);if(!e.ok)throw new Error("Network problem. ");console.log("loading data");let o=await e.json();return console.log(o),o}catch(e){console.log("Error loading products",e)}}(e)))).then((t=>{t.forEach((e=>{(!e??"fulfilled"!==e.status)||r.push(e.value)})),a("category",n),r.length<20?(e.removeAttribute("disabled"),e.innerHTML="Загрузить еще"):e.innerHTML="Нет данных для загрузки"})).catch((e=>console.log(e)))})(e.target),e.target.setAttribute("disabled",""),e.target.textContent="Загрузка..."})),u.addEventListener("click",(()=>async function(){try{console.log("Sending fetch request for deleting product10");let e=await fetch("https://fakestoreapi.com/products/10",{method:"DELETE"});if(!e.ok)throw new Error("Network problem");let t=await e.json();if(null===t)throw console.dir(t),new Error("Удаляемый продкут в базе данных отсутствует");return 10===t.id&&alert(`Продукт: /n ${t.title} /n /n Успешно удален`),console.log("Результат удаления объекта:"),console.dir(t),t}catch(e){alert("Error deleting product "+e)}}())),g.addEventListener("click",(()=>async function(e){const t={method:"POST",body:JSON.stringify(e)};try{console.log("Sending fetch request for adding new product");let e=await fetch("https://fakestoreapi.com/products",t);if(!e.ok)throw new Error("Network error");console.log("Loading server response of adding new product");let o=await e.json();return console.log("Result of adding new product"),console.dir(o),alert(`New product added. Assigned id - ${o.id}`),o}catch(e){console.log("Результат добавления нового объекта"),console.log("Ошибка добавления нового товара ",e)}}(m)))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q0FBRSxNQUFPNkIsR0FDUDBDLE1BQU0sMEJBQTRCMUMsRUFDcEMsQ0FDRixDRjNCaUQyQyxLQUNqRGpFLEVBQWNrQyxpQkFBaUIsU0FBUyxJRTRCakNyQixlQUEwQjlELEdBQy9CLE1BQ01tSCxFQUFVLENBQ2RKLE9BQVEsT0FDUnRELEtBQU0yRCxLQUFLQyxVQUFVckgsSUFHdkIsSUFDRWtFLFFBQVFDLElBQUksZ0RBQ1osSUFBSUosUUFBZUssTUFSVCxvQ0FRb0IrQyxHQUM5QixJQUFLcEQsRUFBT00sR0FBSSxNQUFNLElBQUlwQyxNQUFNLGlCQUNoQ2lDLFFBQVFDLElBQUksaURBRVosSUFBSXpCLFFBQWNxQixFQUFPTyxPQU16QixPQUpBSixRQUFRQyxJQUFJLGdDQUNaRCxRQUFROEMsSUFBSXRFLEdBQ1p1RSxNQUFNLG9DQUFvQ3ZFLEVBQU1sQyxNQUV6Q2tDLENBRVQsQ0FBRSxNQUFPNkIsR0FDUEwsUUFBUUMsSUFBSSx1Q0FDWkQsUUFBUUMsSUFBSSxtQ0FBb0NJLEVBQ2xELENBQ0YsQ0ZyRDhDK0MsQ0FBV3BFLEkiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91cmJhbl9leDEwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9wcm9kdWN0TGlzdC9wcm9kdWN0Q2FyZC9wcm9kdWN0Q2FyZC5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwL3dlYnBhY2svcnVudGltZS9nbG9iYWwiLCJ3ZWJwYWNrOi8vdXJiYW5fZXgxMC93ZWJwYWNrL3J1bnRpbWUvcHVibGljUGF0aCIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL21vZHVsZXMvcHJvZHVjdExpc3QvcHJvZHVjdExpc3QuanMiLCJ3ZWJwYWNrOi8vdXJiYW5fZXgxMC8uL3NyYy9pbmRleC5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL21vZHVsZXMvSGVhZGVyL2hlYWRlci5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL3NjcmlwdHMvZGF0YUxvYWRpbmcuanMiLCJ3ZWJwYWNrOi8vdXJiYW5fZXgxMC8uL3NyYy9tb2R1bGVzL3Byb2R1Y3RMaXN0L2NhdGVnb3J5RmlsdGVyL2NhdGVnb3J5RmlsdGVyLmpzIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9mb290ZXIvZm9vdGVyLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCJpbXBvcnQgJy4vcHJvZHVjdENhcmQuc2NzcydcblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dQcm9kdWN0Q2FyZChwcm9kdWN0RGF0YSwgcGFyZW50KSB7XG5cbiAgbGV0IHByb2R1Y3RDYXJkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgcHJvZHVjdENhcmQuY2xhc3NOYW1lID0gJ3Byb2R1Y3RDYXJkJztcbiAgcHJvZHVjdENhcmQuZGF0YXNldC5wcm9kdWN0SWQgPSBwcm9kdWN0RGF0YS5pZDtcblxuICBwcm9kdWN0Q2FyZC5pbm5lckhUTUwgPSBgPGRpdiBjbGFzcz1cInByb2R1Y3RDYXJkX19pbWdDb250YWluZXJcIj5cbiAgICAgIDxpbWcgY2xhc3M9XCJwcm9kdWN0Q2FyZF9faW1nXCIgc3JjPVwiJHtwcm9kdWN0RGF0YS5pbWFnZX1cIiBhbHQ9XCJpbWFnZVwiPlxuICAgIDwvZGl2PlxuICAgIDxkaXYgY2xhc3M9XCJwcm9kdWN0Q2FyZF9faW5mb1wiPlxuICAgICAgPGgzIGNsYXNzPVwicHJvZHVjdENhcmRfX3RpdGxlXCI+JHtwcm9kdWN0RGF0YS50aXRsZX08L2gzPlxuICAgICAgPHAgY2xhc3M9XCJwcm9kdWN0Q2FyZF9fY2F0ZWdvcnlcIj4ke3Byb2R1Y3REYXRhLmNhdGVnb3J5fTwvcD5cbiAgICAgIDxwIGNsYXNzPVwicHJvZHVjdENhcmRfX3ByaWNlXCI+JHtwcm9kdWN0RGF0YS5wcmljZX08L3A+XG4gICAgPC9kaXY+YDtcblxuICBwYXJlbnQuYXBwZW5kQ2hpbGQocHJvZHVjdENhcmQpO1xuXG59XG5cbiIsIl9fd2VicGFja19yZXF1aXJlX18uZyA9IChmdW5jdGlvbigpIHtcblx0aWYgKHR5cGVvZiBnbG9iYWxUaGlzID09PSAnb2JqZWN0JykgcmV0dXJuIGdsb2JhbFRoaXM7XG5cdHRyeSB7XG5cdFx0cmV0dXJuIHRoaXMgfHwgbmV3IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdH0gY2F0Y2ggKGUpIHtcblx0XHRpZiAodHlwZW9mIHdpbmRvdyA9PT0gJ29iamVjdCcpIHJldHVybiB3aW5kb3c7XG5cdH1cbn0pKCk7IiwidmFyIHNjcmlwdFVybDtcbmlmIChfX3dlYnBhY2tfcmVxdWlyZV9fLmcuaW1wb3J0U2NyaXB0cykgc2NyaXB0VXJsID0gX193ZWJwYWNrX3JlcXVpcmVfXy5nLmxvY2F0aW9uICsgXCJcIjtcbnZhciBkb2N1bWVudCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5kb2N1bWVudDtcbmlmICghc2NyaXB0VXJsICYmIGRvY3VtZW50KSB7XG5cdGlmIChkb2N1bWVudC5jdXJyZW50U2NyaXB0ICYmIGRvY3VtZW50LmN1cnJlbnRTY3JpcHQudGFnTmFtZS50b1VwcGVyQ2FzZSgpID09PSAnU0NSSVBUJylcblx0XHRzY3JpcHRVcmwgPSBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnNyYztcblx0aWYgKCFzY3JpcHRVcmwpIHtcblx0XHR2YXIgc2NyaXB0cyA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO1xuXHRcdGlmKHNjcmlwdHMubGVuZ3RoKSB7XG5cdFx0XHR2YXIgaSA9IHNjcmlwdHMubGVuZ3RoIC0gMTtcblx0XHRcdHdoaWxlIChpID4gLTEgJiYgKCFzY3JpcHRVcmwgfHwgIS9eaHR0cChzPyk6Ly50ZXN0KHNjcmlwdFVybCkpKSBzY3JpcHRVcmwgPSBzY3JpcHRzW2ktLV0uc3JjO1xuXHRcdH1cblx0fVxufVxuLy8gV2hlbiBzdXBwb3J0aW5nIGJyb3dzZXJzIHdoZXJlIGFuIGF1dG9tYXRpYyBwdWJsaWNQYXRoIGlzIG5vdCBzdXBwb3J0ZWQgeW91IG11c3Qgc3BlY2lmeSBhbiBvdXRwdXQucHVibGljUGF0aCBtYW51YWxseSB2aWEgY29uZmlndXJhdGlvblxuLy8gb3IgcGFzcyBhbiBlbXB0eSBzdHJpbmcgKFwiXCIpIGFuZCBzZXQgdGhlIF9fd2VicGFja19wdWJsaWNfcGF0aF9fIHZhcmlhYmxlIGZyb20geW91ciBjb2RlIHRvIHVzZSB5b3VyIG93biBsb2dpYy5cbmlmICghc2NyaXB0VXJsKSB0aHJvdyBuZXcgRXJyb3IoXCJBdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIGluIHRoaXMgYnJvd3NlclwiKTtcbnNjcmlwdFVybCA9IHNjcmlwdFVybC5yZXBsYWNlKC8jLiokLywgXCJcIikucmVwbGFjZSgvXFw/LiokLywgXCJcIikucmVwbGFjZSgvXFwvW15cXC9dKyQvLCBcIi9cIik7XG5fX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBzY3JpcHRVcmw7IiwiaW1wb3J0IHsgZ2V0Q2F0ZWdvcmllcywgbG9hZFByb2R1Y3RzLCBsb2FkU2luZ2xlUHJvZHVjdCB9IGZyb20gXCJAL3NjcmlwdHMvZGF0YUxvYWRpbmcuanNcIjtcbmltcG9ydCB7IHNldENhdGVnb3J5U2VsZWN0IH0gZnJvbSBcIkAvbW9kdWxlcy9wcm9kdWN0TGlzdC9jYXRlZ29yeUZpbHRlci9jYXRlZ29yeUZpbHRlci5qc1wiO1xuaW1wb3J0IHsgc2hvd1Byb2R1Y3RDYXJkIH0gZnJvbSBcIkAvbW9kdWxlcy9wcm9kdWN0TGlzdC8vcHJvZHVjdENhcmQvcHJvZHVjdENhcmQuanNcIjtcbmltcG9ydCAnQC9tb2R1bGVzL3Byb2R1Y3RMaXN0Ly9wcm9kdWN0TGlzdC5zY3NzJztcblxuY29uc3QgcHJvZHVjdExpc3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInByb2R1Y3QtbGlzdFwiKTtcblxubGV0IHByb2R1Y3RzRGF0YSA9IFtdO1xuXG5cbi8qbGV0IGNhdGVnb3JpZXMgPSBnZXRDYXRlZ29yaWVzKCkudGhlbih2YWx1ZSA9PiB7XG4gIGNvbnNvbGUubG9nKFwiQ2F0ZWdvcmllcyBsb2FkZWQgaW4gUHJvZHVjdCBsaXN0IG1vZHVsZVwiLCB2YWx1ZSk7XG4gIHJldHVybiB2YWx1ZTtcblxufSk7Ki9cblxubGV0IGNhdGVnb3J5RmlsdGVyID0gJyc7XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluaXRQcm9kdWN0TGlzdCgpIHtcbiAgdHJ5IHtcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgbG9hZFByb2R1Y3RzKDYpO1xuICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG5cbiAgICByZXN1bHQuZm9yRWFjaChwcm9kID0+IHtcbiAgICAgIHNob3dQcm9kdWN0Q2FyZChwcm9kLCBwcm9kdWN0TGlzdCk7XG4gICAgICBwcm9kdWN0c0RhdGEucHVzaChwcm9kKTtcbiAgICB9KTtcbiAgICBzZXRDYXRlZ29yeVNlbGVjdChwcm9kdWN0TGlzdCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5sb2coJ2Vycm9yIGxvYWRpbmcgZGF0YSBmcm9tIEFQSScsIGVycm9yKTtcbiAgfVxuXG59XG5cbmV4cG9ydCBmdW5jdGlvbiBsb2FkTW9yZVByb2R1Y3RzKGJ0bikge1xuXG4gIGNvbnNvbGUubG9nKFwibG9hZCBtb3JlIHByb2R1Y3RzIGNhbGxlZFwiKTtcblxuICBpZiAocHJvZHVjdHNEYXRhLmxlbmd0aCA+PSAyMCkgcmV0dXJuO1xuXG4gIGNvbnN0IGxvYWRDb3VudCA9IE1hdGgubWluKDYsIDIwIC0gcHJvZHVjdHNEYXRhLmxlbmd0aCk7XG4gIGxldCBwcm9kdWN0SWRBcnIgPSBuZXcgQXJyYXkobG9hZENvdW50KS5maWxsKClcbiAgICAubWFwKChfLCBpKSA9PiBwcm9kdWN0c0RhdGEubGVuZ3RoICsgaSArIDEpO1xuXG4gIFByb21pc2UuYWxsU2V0dGxlZChwcm9kdWN0SWRBcnIubWFwKGlkID0+IGxvYWRTaW5nbGVQcm9kdWN0KGlkKSkpXG4gICAgLnRoZW4ocmVzdWx0cyA9PiB7XG4gICAgICByZXN1bHRzLmZvckVhY2goKHByb2R1Y3REYXRhKSA9PiB7XG4gICAgICAgIGlmICghcHJvZHVjdERhdGEgPz8gcHJvZHVjdERhdGEuc3RhdHVzICE9PSAnZnVsZmlsbGVkJykgcmV0dXJuO1xuXG4gICAgICAgIHByb2R1Y3RzRGF0YS5wdXNoKHByb2R1Y3REYXRhLnZhbHVlKTtcblxuICAgICAgfSk7XG5cbiAgICAgIGZpbHRlclByb2R1Y3RMaXN0KFwiY2F0ZWdvcnlcIiwgY2F0ZWdvcnlGaWx0ZXIpXG5cbiAgICAgIGlmIChwcm9kdWN0c0RhdGEubGVuZ3RoIDwgMjApIHtcbiAgICAgICAgYnRuLnJlbW92ZUF0dHJpYnV0ZSgnZGlzYWJsZWQnKTtcbiAgICAgICAgYnRuLmlubmVySFRNTCA9IFwi0JfQsNCz0YDRg9C30LjRgtGMINC10YnQtVwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnRuLmlubmVySFRNTCA9IFwi0J3QtdGCINC00LDQvdC90YvRhSDQtNC70Y8g0LfQsNCz0YDRg9C30LrQuFwiO1xuICAgICAgfVxuICAgIH0pLmNhdGNoKGVycm9yID0+IGNvbnNvbGUubG9nKGVycm9yKSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaWx0ZXJQcm9kdWN0TGlzdChmaWx0ZXJCeSwgdmFsdWUpIHtcbiAgbGV0IGZpbHRlcmVkUHJvZHVjdHM7XG4gIHByb2R1Y3RMaXN0LmlubmVySFRNTCA9ICcnO1xuICBjYXRlZ29yeUZpbHRlciA9IHZhbHVlO1xuXG4gIGlmICh2YWx1ZSAhPT0gJycpIHtcbiAgICBmaWx0ZXJlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhLmZpbHRlcihwcm9kID0+IHByb2RbZmlsdGVyQnldID09PSB2YWx1ZSk7XG4gIH0gZWxzZSB7XG4gICAgZmlsdGVyZWRQcm9kdWN0cyA9IHByb2R1Y3RzRGF0YTtcbiAgfVxuXG4gIGZpbHRlcmVkUHJvZHVjdHMuZm9yRWFjaChwcm9kID0+IHNob3dQcm9kdWN0Q2FyZChwcm9kLCBwcm9kdWN0TGlzdCkpO1xuXG59XG5cblxuIiwiLy9pbXBvcnQgeyBzaG93UHJvZHVjdENhcmQgfSBmcm9tIFwiLi9tb2R1bGVzL3Byb2R1Y3RDYXJkL3Byb2R1Y3RDYXJkLmpzXCI7XG5pbXBvcnQgeyBpbml0UHJvZHVjdExpc3QsIGxvYWRNb3JlUHJvZHVjdHMsIHNldENhdGVnb3J5U2VsZWN0IH0gZnJvbSBcIkAvbW9kdWxlcy9wcm9kdWN0TGlzdC9wcm9kdWN0TGlzdC5qc1wiO1xuaW1wb3J0IHsgYWRkUHJvZHVjdCwgZGVsZXRlUHJvZHVjdCwgZ2V0Q2F0ZWdvcmllcyB9IGZyb20gXCJAL3NjcmlwdHMvZGF0YUxvYWRpbmcuanNcIjtcbi8vaW1wb3J0IHsgbG9hZFByb2R1Y3RzIH0gZnJvbSBcIi4vc2NyaXB0cy9kYXRhTG9hZGluZy5qc1wiO1xuaW1wb3J0IFwiQC9zdHlsZXMvbWFpbi5zY3NzXCI7XG5pbXBvcnQgeyBzaG93SGVhZGVyIH0gZnJvbSBcIkAvbW9kdWxlcy9IZWFkZXIvaGVhZGVyLmpzXCI7XG5pbXBvcnQgeyBzaG93Rm9vdGVyIH0gZnJvbSBcIkAvbW9kdWxlcy9mb290ZXIvZm9vdGVyLmpzXCI7XG5cbmNvbnN0IGJ0bkxvYWRNb3JlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRNb3JlUHJvZHVjdHMnKTtcbmNvbnN0IGJ0bkRlbGV0ZVByb2R1Y3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZGVsZXRlUHJvZHVjdCcpO1xuY29uc3QgYnRuQWRkUHJvZHVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhZGRQcm9kdWN0Jyk7XG5cbmNvbnN0IHNhbXBsZVByb2R1Y3REYXRhID0ge1xuICB0aXRsZTogJ3Rlc3QgcHJvZHVjdCcsXG4gIHByaWNlOiAxMy41LFxuICBkZXNjcmlwdGlvbjogJ2xvcmVtIGlwc3VtIHNldCcsXG4gIGltYWdlOiAnaHR0cHM6Ly9pLnByYXZhdGFyLmNjJyxcbiAgY2F0ZWdvcnk6ICdlbGVjdHJvbmljJ1xufVxuXG5zaG93SGVhZGVyKCk7XG5cbmluaXRQcm9kdWN0TGlzdCgpO1xuLy9nZXRDYXRlZ29yaWVzKCk7XG5zaG93Rm9vdGVyKCk7XG5cbmNvbnNvbGUubG9nKFwibG9hZGVkIGZyb20gaW5kZXguanNcIik7XG5cbmNvbnNvbGUubG9nKFwiaW5kZXguanMgY29kZSBydW5zLiBEZXYgc2VydmVyIGFuZCBhdXRvIHJlbG9hZCB3b3Jrc1wiKTtcblxuYnRuTG9hZE1vcmUuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIChldmVudCkgPT4ge1xuICBsb2FkTW9yZVByb2R1Y3RzKGV2ZW50LnRhcmdldCk7XG4gIGV2ZW50LnRhcmdldC5zZXRBdHRyaWJ1dGUoJ2Rpc2FibGVkJywgJycpO1xuICBldmVudC50YXJnZXQudGV4dENvbnRlbnQgPSAn0JfQsNCz0YDRg9C30LrQsC4uLic7XG59KTtcblxuXG4vL2J0bkxvYWRNb3JlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBsb2FkTW9yZVByb2R1Y3RzKVxuXG5idG5EZWxldGVQcm9kdWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBkZWxldGVQcm9kdWN0KDEwKSk7XG5idG5BZGRQcm9kdWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiBhZGRQcm9kdWN0KHNhbXBsZVByb2R1Y3REYXRhKSk7XG5cblxuXG5cblxuXG5cblxuXG4iLCJpbXBvcnQgJy4vaGVhZGVyLnNjc3MnO1xuaW1wb3J0IExvZ28gZnJvbSAnLi9Mb2dvS3Jpc3Quc3ZnJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dIZWFkZXIoKSB7XG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoZWFkZXJcIik7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBsb2dvRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIC8vIGNvbnN0IGxvZ28gPSBuZXcgSW1hZ2UoKTtcbiAgY29uc3QgbmF2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm5hdlwiKTtcbiAgY29uc3QgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJvZHlcIilbMF07XG4gIC8vY29uc29sZS5sb2coYm9keS5wcmVwZW5kKTtcblxuXG4gIGhlYWRlci5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImhlYWRlclwiKTtcbiAgaGVhZGVyLmNsYXNzTmFtZSA9IFwiaGVhZGVyXCI7XG5cbiAgd3JhcHBlci5jbGFzc05hbWUgPSBcImhlYWRlcl9fY29udGVudFdyYXBwZXJcIjtcblxuICBsb2dvRWxlbS5jbGFzc05hbWUgPSBcImhlYWRlcl9fbG9nb1wiO1xuXG4gIGxvZ29FbGVtLmlubmVySFRNTCA9XG4gICAgYDxpbWcgc3JjPVwiJHtMb2dvfVwiIGFsdD1cImxvZ29cIj5gO1xuICAvKlxuICBsb2dvLnNyYyA9IExvZ287XG4gIGxvZ28uYWx0ID0gXCJsb2dvXCI7XG4gIGxvZ29FbGVtLmFwcGVuZENoaWxkKGxvZ28pOyovXG5cbiAgbmF2LmNsYXNzTmFtZSA9IFwiaGVhZGVyX19uYXZcIjtcbiAgbmF2LmlubmVySFRNTCA9XG4gICAgYDx1bD5cbiAgICAgICAgICA8bGk+SG9tZTwvbGk+XG4gICAgICAgICAgPGxpPlNob3A8L2xpPlxuICAgICAgICAgIDxsaT5PdXIgU3Rvcnk8L2xpPlxuICAgICAgICAgIDxsaT5CbG9nPC9saT5cbiAgICAgICAgICA8bGk+Q29udGFjdCBVczwvbGk+XG4gICAgICAgIDwvdWw+YDtcblxuXG4gIG1lbnUuY2xhc3NOYW1lID0gXCJoZWFkZXJfX21lbnVcIjtcbiAgbWVudS5pbm5lckhUTUwgPSBcIk1lbnUgaXRlbXNcIjtcblxuXG5cbiAgLy9UT0RPOiBhcHBlbmQgbG9nbyBmcm9tIG1vZHVsZVxuICAvL1RPRE86IGFwcGVuZCBuYXYgZnJvbSBtb2R1bGVcbiAgLy9UT0RPOiBhcHBlbmQgbWVudSBmcm9tIG1vZHVsZVxuXG4gIHdyYXBwZXIuYXBwZW5kKGxvZ29FbGVtLCBuYXYsIG1lbnUpO1xuICBoZWFkZXIuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG5cbiAgYm9keS5wcmVwZW5kKGhlYWRlcik7XG4gIC8qXG5cbiAgaGVhZGVyLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiaGVhZGVyX19jb250ZW50V3JhcHBlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlcl9fbG9nb1wiPlxuICAgICAgICA8aW1nIHNyYz1cIi4uL3B1YmxpYy9pbWcvTG9nb0tyaXN0LnN2Z1wiIGFsdD1cIkxvZ29cIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPG5hdiBjbGFzcz1cImhlYWRlcl9fbmF2XCI+XG4gICAgICAgIDx1bD5cbiAgICAgICAgICA8bGk+SG9tZTwvbGk+XG4gICAgICAgICAgPGxpPlNob3A8L2xpPlxuICAgICAgICAgIDxsaT5PdXIgU3Rvcnk8L2xpPlxuICAgICAgICAgIDxsaT5CbG9nPC9saT5cbiAgICAgICAgICA8bGk+Q29udGFjdCBVczwvbGk+XG4gICAgICAgIDwvdWw+XG4gICAgICA8L25hdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJfX21lbnVcIj5NZW51IGl0ZW1zPC9kaXY+XG4gICAgPC9kaXY+YFxuKi9cbiAgcmV0dXJuIGhlYWRlcjtcbn1cbiIsImV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkUHJvZHVjdHMobGltaXQpIHtcbiAgbGV0IHVybCA9ICdodHRwczovL2Zha2VzdG9yZWFwaS5jb20vcHJvZHVjdHMnO1xuXG4gIGlmICghaXNOYU4oK2xpbWl0KSkge1xuICAgIHVybCA9IHVybCArIGA/bGltaXQ9JHtsaW1pdH1gO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgZmV0Y2ggcmVxdWVzdFwiKTtcbiAgICBsZXQgcmVzdWx0ID0gYXdhaXQgZmV0Y2godXJsKTtcbiAgICBpZiAoIXJlc3VsdC5vaykgdGhyb3cgbmV3IEVycm9yKFwiTmV0d29yayBlcnJvclwiKTtcbiAgICBjb25zb2xlLmxvZyhcImxvYWRpbmcgZGF0YVwiKTtcbiAgICBsZXQgdmFsdWUgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKHZhbHVlKTtcbiAgICByZXR1cm4gdmFsdWU7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZyhcIkVycm9yIGxvYWRpbmcgcHJvZHVjdHNcIiwgZXJyb3IpO1xuICB9XG59XG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRTaW5nbGVQcm9kdWN0KHByb2R1Y3RJZCkge1xuICBsZXQgdXJsID0gYGh0dHBzOi8vZmFrZXN0b3JlYXBpLmNvbS9wcm9kdWN0cy8ke3Byb2R1Y3RJZH1gO1xuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coXCJTZW5kaW5nIGZldGNoIHJlcXVlc3RcIik7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgaWYgKCFyZXN1bHQub2spIHRocm93IG5ldyBFcnJvcignTmV0d29yayBwcm9ibGVtLiAnKTtcblxuICAgIGNvbnNvbGUubG9nKFwibG9hZGluZyBkYXRhXCIpO1xuICAgIGxldCB2YWx1ZSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2codmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgbG9hZGluZyBwcm9kdWN0c1wiLCBlcnJvcik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3QocHJvZHVjdElkKSB7XG4gIGxldCB1cmwgPSBgaHR0cHM6Ly9mYWtlc3RvcmVhcGkuY29tL3Byb2R1Y3RzLyR7cHJvZHVjdElkfWA7XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhgU2VuZGluZyBmZXRjaCByZXF1ZXN0IGZvciBkZWxldGluZyBwcm9kdWN0JHtwcm9kdWN0SWR9YCk7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGZldGNoKHVybCwgeyBtZXRob2Q6ICdERUxFVEUnIH0pO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoJ05ldHdvcmsgcHJvYmxlbScpO1xuXG4gICAgbGV0IHZhbHVlID0gYXdhaXQgcmVzdWx0Lmpzb24oKTtcblxuICAgIGlmICh2YWx1ZSA9PT0gbnVsbCkge1xuICAgICAgY29uc29sZS5kaXIodmFsdWUpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwi0KPQtNCw0LvRj9C10LzRi9C5INC/0YDQvtC00LrRg9GCINCyINCx0LDQt9C1INC00LDQvdC90YvRhSDQvtGC0YHRg9GC0YHRgtCy0YPQtdGCXCIpO1xuICAgIH1cblxuICAgIGlmICh2YWx1ZS5pZCA9PT0gcHJvZHVjdElkKSB7XG4gICAgICBhbGVydChg0J/RgNC+0LTRg9C60YI6IC9uICR7dmFsdWUudGl0bGV9IC9uIC9uINCj0YHQv9C10YjQvdC+INGD0LTQsNC70LXQvWApO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKCfQoNC10LfRg9C70YzRgtCw0YIg0YPQtNCw0LvQtdC90LjRjyDQvtCx0YrQtdC60YLQsDonKTtcbiAgICBjb25zb2xlLmRpcih2YWx1ZSk7XG4gICAgcmV0dXJuIHZhbHVlO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgYWxlcnQoXCJFcnJvciBkZWxldGluZyBwcm9kdWN0IFwiICsgZXJyb3IpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9kdWN0KHByb2R1Y3REYXRhKSB7XG4gIGNvbnN0IHVybCA9ICdodHRwczovL2Zha2VzdG9yZWFwaS5jb20vcHJvZHVjdHMnO1xuICBjb25zdCBvcHRpb25zID0ge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocHJvZHVjdERhdGEpXG4gIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgZmV0Y2ggcmVxdWVzdCBmb3IgYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoXCJOZXR3b3JrIGVycm9yXCIpO1xuICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBzZXJ2ZXIgcmVzcG9uc2Ugb2YgYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuXG4gICAgbGV0IHZhbHVlID0gYXdhaXQgcmVzdWx0Lmpzb24oKTtcblxuICAgIGNvbnNvbGUubG9nKFwiUmVzdWx0IG9mIGFkZGluZyBuZXcgcHJvZHVjdFwiKTtcbiAgICBjb25zb2xlLmRpcih2YWx1ZSk7XG4gICAgYWxlcnQoYE5ldyBwcm9kdWN0IGFkZGVkLiBBc3NpZ25lZCBpZCAtICR7dmFsdWUuaWR9YCk7XG5cbiAgICByZXR1cm4gdmFsdWU7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmxvZygn0KDQtdC30YPQu9GM0YLQsNGCINC00L7QsdCw0LLQu9C10L3QuNGPINC90L7QstC+0LPQviDQvtCx0YrQtdC60YLQsCcpO1xuICAgIGNvbnNvbGUubG9nKCfQntGI0LjQsdC60LAg0LTQvtCx0LDQstC70LXQvdC40Y8g0L3QvtCy0L7Qs9C+INGC0L7QstCw0YDQsCAnLCBlcnJvcik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldENhdGVnb3JpZXMoKSB7XG4gIGNvbnN0IHVybCA9ICdodHRwczovL2Zha2VzdG9yZWFwaS5jb20vcHJvZHVjdHMvY2F0ZWdvcmllcyc7XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgZmV0Y2ggcmVxdWVzdCBmb3IgbG9hZCBjYXRlZ29yaWVzXCIpO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKTtcblxuICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBjYXRlZ29yaWVzIG5hbWVzXCIpO1xuICAgIGxldCB2YWx1ZSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2codmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUubG9nKFwiRXJyb3IgbG9hZGluZyBjYXRlZ29yaWVzIFwiLCBlcnJvcik7XG4gIH1cbn1cbiIsImltcG9ydCB7IGdldENhdGVnb3JpZXMgfSBmcm9tIFwiLi4vLi4vLi4vc2NyaXB0cy9kYXRhTG9hZGluZ1wiO1xuaW1wb3J0IHsgZmlsdGVyUHJvZHVjdExpc3QgfSBmcm9tIFwiLi4vcHJvZHVjdExpc3RcIjtcblxuXG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENhdGVnb3J5U2VsZWN0KHBhcmVudEVsZW1lbnQpIHtcbiAgbGV0IGNhdGVnb3J5RmlsdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNhdGVnb3J5RmlsdGVyLmNsYXNzTmFtZSA9ICdwcm9kdWN0TGlzdF9fY2F0ZWdvcmllcyc7XG4gIGNhdGVnb3J5RmlsdGVyLnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvZHVjdExpc3RfX2NhdGVnb3JpZXMnKTtcblxuICBnZXRDYXRlZ29yaWVzKCkudGhlbih2YWx1ZSA9PiBzaG93Q2F0ZWdvcnlTZWxlY3QodmFsdWUsIGNhdGVnb3J5RmlsdGVyKSk7XG5cblxuICBwYXJlbnRFbGVtZW50LnBhcmVudE5vZGUucHJlcGVuZChjYXRlZ29yeUZpbHRlcik7XG4gIGNhdGVnb3J5RmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsXG4gICAgKGV2ZW50KSA9PiBmaWx0ZXJQcm9kdWN0TGlzdCgnY2F0ZWdvcnknLCBldmVudC50YXJnZXQudmFsdWUpKTtcblxufVxuXG5mdW5jdGlvbiBzaG93Q2F0ZWdvcnlTZWxlY3Qoc2VsZWN0RGF0YSwgZWxlbSkge1xuICBsZXQgY2F0ZWdvcmllcyA9ICc8b3B0aW9uIHZhbHVlPVwiXCI+LS1TaG93IGFsbCBwcm9kdWN0cy0tPC9vcHRpb24+JztcblxuICBzZWxlY3REYXRhLmZvckVhY2goY2F0ZWdvcnkgPT4ge1xuICAgIGNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzICsgYDxvcHRpb24gdmFsdWU9XCIke2NhdGVnb3J5fVwiPlxuICAgICAgICAke2NhdGVnb3J5fVxuICAgICAgPC9vcHRpb24+YDtcbiAgfSk7XG5cbiAgbGV0IGNhdGVnb3J5U2VsZWN0ID0gYDxsYWJlbCBmb3I9XCJwcm9kdWN0TGlzdF9fc2VsZWN0XCI+XG4gICAgICBTaG93IHByb2R1Y3RzIGZpbHRlcmVkIGJ5IGNhdGVnb3J5OlxuICAgIDwvbGFiZWw+XG4gICAgPHNlbGVjdCBuYW1lPVwicHJvZHVjdExpc3RfX3NlbGVjdFwiIGlkPVwicHJvZHVjdExpc3RfX3NlbGVjdFwiPlxuICAgICAgJHtjYXRlZ29yaWVzfTtcbiAgICA8L3NlbGVjdD5gO1xuXG4gIGVsZW0uaW5uZXJIVE1MID0gY2F0ZWdvcnlTZWxlY3Q7XG5cbiAgLy9jb25zb2xlLmxvZyhjYXRlZ29yeVNlbGVjdCk7XG4gIC8vcHJvZHVjdExpc3QucGFyZW50Tm9kZS5wcmVwZW5kKGVsZW0pO1xuICAvKiBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsXG4gICAgIChldmVudCkgPT4gZmlsdGVyUHJvZHVjdExpc3QoJ2NhdGVnb3J5JywgZXZlbnQudGFyZ2V0LnZhbHVlKSk7Ki9cbn1cbiIsImltcG9ydCAnLi9mb290ZXIuc2Nzcyc7XG5pbXBvcnQgTG9nbyBmcm9tICcuL0xvZ29LcmlzdC5zdmcnO1xuaW1wb3J0IEVudmVsb3BlIGZyb20gJy4vaWNvbnMvZW52ZWxvcGUuc3ZnJztcbmltcG9ydCBQaG9uZSBmcm9tICcuL2ljb25zL3Bob25lLnN2Zyc7XG5pbXBvcnQgUG9pbnRlciBmcm9tICcuL2ljb25zL3BvaW50ZXIuc3ZnJztcblxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd0Zvb3RlcigpIHtcbiAgY29uc3QgYm9keSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiYm9keVwiKVswXTtcbiAgY29uc3QgZm9vdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImZvb3RlclwiKTtcbiAgY29uc3Qgd3JhcHBlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGZvb3RlckNvbnRlbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBmb290ZXJCb3R0b20gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBmb290ZXJBZGRyZXNzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFkZHJlc3NcIik7XG4gIGNvbnN0IGZvb3RlckluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBmb290ZXJTZXJ2aWNlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgZm9vdGVyU3Vic2NyaWJlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblxuICBmb290ZXJBZGRyZXNzLmNsYXNzTmFtZSA9IFwiZm9vdGVyX19hZGRyZXNzXCJcbiAgZm9vdGVyQWRkcmVzcy5pbm5lckhUTUwgPSBgXG4gICAgPHA+XG4gICAgICA8aW1nIHNyYz0ke0xvZ299IGFsdD1cIkxvZ29cIiBjbGFzcz1cImZvb3Rlcl9fbG9nb1wiPlxuICAgIDwvcD5cbiAgICA8cD5cbiAgICAgIDxpbWcgc3JjPSR7UGhvbmV9IGFsdD1cInBob25lXCIgd2lkdGg9MjQgaGVpZ2h0PTI0PlxuICAgICAgPGEgaHJlZj1cInRlbDorMSA3MDQ1NTUwMTI3XCI+KDcwNCkgNTU1LTAxMjc8L2E+XG4gICAgPC9wPlxuICAgIDxwPlxuICAgICAgPGltZyBzcmM9JHtFbnZlbG9wZX0gYWx0PVwibWFpbFwiIHdpZHRoPTI0IGhlaWdodD0yND5cbiAgICAgIDxhIGhyZWY9XCJtYWlsdG86a3Jpc3RAZXhhbXBsZS5jb21cIj5rcmlzdEBleGFtcGxlLmNvbTwvYT5cbiAgICA8L3A+XG4gICAgPHA+XG4gICAgICA8aW1nIHNyYz0ke1BvaW50ZXJ9IGFsdD1cImFkZHJlc3NcIiB3aWR0aD0yNCBoZWlnaHQ9MjQ+XG4gICAgICA8c3Bhbj4zODkxIFJhbmNoPC9zcGFuPlxuICAgIDwvcD5gO1xuXG4gIGZvb3RlckNvbnRlbnQuYXBwZW5kKGZvb3RlckFkZHJlc3MpO1xuXG5cblxuICBmb290ZXIuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJmb290ZXJcIik7XG4gIGZvb3Rlci5jbGFzc05hbWUgPSBcImZvb3RlclwiO1xuXG5cbiAgd3JhcHBlci5jbGFzc05hbWUgPSBcImZvb3Rlcl9fd3JhcHBlclwiO1xuICB3cmFwcGVyLmFwcGVuZChmb290ZXJDb250ZW50LCBmb290ZXJCb3R0b20pO1xuICBmb290ZXIuYXBwZW5kKHdyYXBwZXIpO1xuXG4gIGJvZHkuYXBwZW5kKGZvb3Rlcik7XG5cblxuXG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNob3dQcm9kdWN0Q2FyZCIsInByb2R1Y3REYXRhIiwicGFyZW50IiwicHJvZHVjdENhcmQiLCJkb2N1bWVudCIsImNyZWF0ZUVsZW1lbnQiLCJjbGFzc05hbWUiLCJkYXRhc2V0IiwicHJvZHVjdElkIiwiaWQiLCJpbm5lckhUTUwiLCJpbWFnZSIsInRpdGxlIiwiY2F0ZWdvcnkiLCJwcmljZSIsImFwcGVuZENoaWxkIiwiZyIsImdsb2JhbFRoaXMiLCJ0aGlzIiwiRnVuY3Rpb24iLCJlIiwid2luZG93Iiwic2NyaXB0VXJsIiwiaW1wb3J0U2NyaXB0cyIsImxvY2F0aW9uIiwiY3VycmVudFNjcmlwdCIsInRhZ05hbWUiLCJ0b1VwcGVyQ2FzZSIsInNyYyIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImxlbmd0aCIsImkiLCJ0ZXN0IiwiRXJyb3IiLCJyZXBsYWNlIiwicCIsInByb2R1Y3RMaXN0IiwiZ2V0RWxlbWVudEJ5SWQiLCJwcm9kdWN0c0RhdGEiLCJjYXRlZ29yeUZpbHRlciIsImZpbHRlclByb2R1Y3RMaXN0IiwiZmlsdGVyQnkiLCJ2YWx1ZSIsImZpbHRlcmVkUHJvZHVjdHMiLCJmaWx0ZXIiLCJwcm9kIiwiZm9yRWFjaCIsImJ0bkxvYWRNb3JlIiwiYnRuRGVsZXRlUHJvZHVjdCIsImJ0bkFkZFByb2R1Y3QiLCJzYW1wbGVQcm9kdWN0RGF0YSIsImRlc2NyaXB0aW9uIiwiaGVhZGVyIiwid3JhcHBlciIsImxvZ29FbGVtIiwibmF2IiwibWVudSIsImJvZHkiLCJzZXRBdHRyaWJ1dGUiLCJhcHBlbmQiLCJwcmVwZW5kIiwic2hvd0hlYWRlciIsImFzeW5jIiwicmVzdWx0IiwidXJsIiwiaXNOYU4iLCJjb25zb2xlIiwibG9nIiwiZmV0Y2giLCJvayIsImpzb24iLCJlcnJvciIsImxvYWRQcm9kdWN0cyIsInB1c2giLCJwYXJlbnRFbGVtZW50IiwiZ2V0Q2F0ZWdvcmllcyIsInRoZW4iLCJzZWxlY3REYXRhIiwiZWxlbSIsImNhdGVnb3JpZXMiLCJjYXRlZ29yeVNlbGVjdCIsInNob3dDYXRlZ29yeVNlbGVjdCIsInBhcmVudE5vZGUiLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJzZXRDYXRlZ29yeVNlbGVjdCIsImluaXRQcm9kdWN0TGlzdCIsImZvb3RlciIsImZvb3RlckNvbnRlbnQiLCJmb290ZXJCb3R0b20iLCJmb290ZXJBZGRyZXNzIiwic2hvd0Zvb3RlciIsImJ0biIsImxvYWRDb3VudCIsIk1hdGgiLCJtaW4iLCJwcm9kdWN0SWRBcnIiLCJBcnJheSIsImZpbGwiLCJtYXAiLCJfIiwiUHJvbWlzZSIsImFsbFNldHRsZWQiLCJsb2FkU2luZ2xlUHJvZHVjdCIsInJlc3VsdHMiLCJzdGF0dXMiLCJyZW1vdmVBdHRyaWJ1dGUiLCJjYXRjaCIsImxvYWRNb3JlUHJvZHVjdHMiLCJ0ZXh0Q29udGVudCIsIm1ldGhvZCIsImRpciIsImFsZXJ0IiwiZGVsZXRlUHJvZHVjdCIsIm9wdGlvbnMiLCJKU09OIiwic3RyaW5naWZ5IiwiYWRkUHJvZHVjdCJdLCJzb3VyY2VSb290IjoiIn0=