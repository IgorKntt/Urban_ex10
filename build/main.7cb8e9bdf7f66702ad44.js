(()=>{"use strict";var e={};function t(e,t){const r=document.getElementById("messageContainer");let n=document.createElement("div");n.className=`message__element ${e}`,n.innerHTML=t,r.append(n),setTimeout((()=>n.remove()),5e3)}function r(e,t){let r=document.createElement("div");r.className="productCard",r.dataset.productId=e.id,r.innerHTML=`<button class="btn btn--delete">Delete product</button>\n    <div class="productCard__imgContainer">\n      <img class="productCard__img" src="${e.image}" alt="image">\n\n    </div>\n    <div class="productCard__info">\n      <h3 class="productCard__title">${e.title}</h3>\n      <p class="productCard__category">${e.category}</p>\n      <p class="productCard__price">${e.price}</p>\n    </div>`,t.appendChild(r)}e.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{var t;e.g.importScripts&&(t=e.g.location+"");var r=e.g.document;if(!t&&r&&(r.currentScript&&"SCRIPT"===r.currentScript.tagName.toUpperCase()&&(t=r.currentScript.src),!t)){var n=r.getElementsByTagName("script");if(n.length)for(var o=n.length-1;o>-1&&(!t||!/^http(s?):/.test(t));)t=n[o--].src}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),e.p=t})();const n=document.getElementById("product-list");let o=[],a="";function c(e,t){let c;n.innerHTML="",a=t,c=""!==t?o.filter((r=>r[e]===t)):o,c.forEach((e=>r(e,n)))}n.addEventListener("click",(e=>{if("Delete product"===e.target.innerHTML){let r=e.target.parentNode.dataset.productId;(async function(e){let r=`https://fakestoreapi.com/products/${e}`;try{console.log(`Sending fetch request for deleting product ${e}`);let n=await fetch(r,{method:"DELETE"});if(!n.ok)throw new Error("Network problem when deleting product");let o=await n.json();if(null===o)throw console.dir(o),new Error("No product in database");return console.log(o.id,e),o.id==e&&t("success",`Product: ${o.title} successfully deleted from database`),console.log(`Received result of deleting product ${o.title}`),console.dir(o),o}catch(e){t("error","Error deleting product "+e)}})(r).then((t=>{t?.id==r&&e.target.parentNode.remove()}))}}));const d=e.p+"7d7081bd4e58ad8aeeed.svg",i=e.p+"7d7081bd4e58ad8aeeed.svg",l=e.p+"57fb51bd3c0d216f8d77.svg",s=e.p+"bfe9ee3da5d9adca399a.svg",u=e.p+"986b24e86270651ca1ba.svg";function p(e,t){if(!e||!t)return null;let r=document.createElement("ul");return r.className="footer__links",r.innerHTML=`<li><h3>${e}</h3></li>`,t.forEach((e=>{r.innerHTML=r.innerHTML+`<li>\n        <a href="${e.href}">${e.name}</a>\n      </li>`})),r}const m=document.getElementById("loadMoreProducts"),g=document.getElementById("btnAddProduct"),h=document.getElementById("btnAddNewProduct"),f=document.getElementById("btnCancelNewProduct"),w=document.querySelector(".popup");!function(){const e=document.createElement("header"),t=document.createElement("div"),r=document.createElement("div"),n=document.createElement("nav"),o=document.createElement("div"),a=document.getElementsByTagName("body")[0];e.setAttribute("id","header"),e.className="header",t.className="header__contentWrapper",r.className="header__logo",r.innerHTML=`<img src="${d}" alt="logo">`,n.className="header__nav",n.innerHTML="<ul>\n          <li>Home</li>\n          <li>Shop</li>\n          <li>Our Story</li>\n          <li>Blog</li>\n          <li>Contact Us</li>\n        </ul>",o.className="header__menu",o.innerHTML="Menu items",t.append(r,n,o),e.appendChild(t),a.prepend(e)}(),async function(){try{let e=await async function(){let e="https://fakestoreapi.com/products";isNaN(6)||(e+="?limit=6");try{console.log("Sending fetch request");let t=await fetch(e);if(!t.ok)throw new Error("Network error");console.log("loading data product data");let r=await t.json();return console.log("Product data loaded. ",r),r}catch(e){t("error","Error loading products "+e)}}();console.log(e),e.forEach((e=>{r(e,n),o.push(e)})),async function(e){let r=document.createElement("div");r.className="productList__categories",r.setAttribute("id","productList__categories"),async function(){try{console.log("Sending fetch request for load categories");let e=await fetch("https://fakestoreapi.com/products/categories");if(!e.ok)throw new Error("Network error while loading categories");console.log("Loading categories names");let t=await e.json();return console.log(t),t}catch(e){t("error","Error loading categories "+e)}}().then((e=>function(e,t){let r='<option value="">--Show all products--</option>';e.forEach((e=>{r+=`<option value="${e}">\n        ${e}\n      </option>`}));let n=`<label for="productList__select">\n      Show products filtered by category:\n    </label>\n    <select name="productList__select" id="productList__select">\n      ${r};\n    </select>`;t.innerHTML=n}(e,r))),e.parentNode.prepend(r),r.addEventListener("change",(e=>c("category",e.target.value)))}(n)}catch(e){t("error","error loading data from API "+e)}}(),function(){const e=document.getElementsByTagName("body")[0],t=document.createElement("footer"),r=document.createElement("div"),n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("address"),c=document.createElement("div");a.className="footer__address",a.innerHTML=`\n    <p>\n      <img src=${i} alt="Logo" class="footer__logo">\n    </p>\n    <p>\n      <img src=${s} alt="phone" width=24 height=24>\n      <a href="tel:+1 7045550127">(704) 555-0127</a>\n    </p>\n    <p>\n      <img src=${l} alt="mail" width=24 height=24>\n      <a href="mailto:krist@example.com">krist@example.com</a>\n    </p>\n    <p>\n      <img src=${u} alt="address" width=24 height=24>\n      <span>3891 Ranchview Dr. Richardson, California 62639</span>\n    </p>`,n.className="footer__content";const d=p("Information",[{href:"#",name:"My Account"},{href:"#",name:"Login"},{href:"#",name:"My Cart"},{href:"#",name:"My Wishlist"},{href:"#",name:"Checkout"}]),m=p("Service",[{href:"#",name:"About Us"},{href:"#",name:"Careers"},{href:"#",name:"Delivery Information"},{href:"#",name:"Privacy Policy"},{href:"#",name:"Terms & Conditions"}]);c.className="footer__subscribe",c.innerHTML=`\n    <h3>Subscribe</h3>\n    <p>Enter your email below to be the first to know\n     about new collections and product launches.</p>\n     <div class="footer__subscribe-email">\n      <img src="${l}" width=24 height=24 alt="envelope">\n      <input type="text" placeholder="Your Email">\n      <span>&#8594</span>\n     </div>\n\n  `,n.append(a,d,m,c),t.setAttribute("id","footer"),t.className="footer",r.className="footer__wrapper",r.append(n,o),t.append(r),e.append(t)}(),m.addEventListener("click",(e=>{(function(e){if(console.log("load more products called"),o.length>=20)return;const r=Math.min(6,20-o.length);let n=new Array(r).fill().map(((e,t)=>o.length+t+1));Promise.allSettled(n.map((e=>async function(e){let r=`https://fakestoreapi.com/products/${e}`;try{console.log("Sending fetch request");let e=await fetch(r);if(!e.ok)throw new Error("Network problem. ");console.log("loading product data");let t=await e.json();return console.log("Product data loaded. ",t),t}catch(e){t("error","Error loading products data "+e)}}(e)))).then((t=>{t.forEach((e=>{(!e??"fulfilled"!==e.status)||o.push(e.value)})),c("category",a),o.length<20?(e.removeAttribute("disabled"),e.innerHTML="Load more"):e.innerHTML="No data for loading"})).catch((e=>t("error",e)))})(e.target),e.target.setAttribute("disabled",""),e.target.textContent="Loading..."})),g.addEventListener("click",(()=>{w.style=""})),h.addEventListener("click",(e=>{e.preventDefault();const r=document.forms.newProduct,n={title:r.newProductName.value,category:r.newProductCategory.value,price:r.newProductPrice.value,image:r.newProductImage.value};for(let e in n)if(""===n[e])return void alert("Все поля формы должны быть заполнены");(async function(e){try{let r=await async function(e){const r={method:"POST",body:JSON.stringify(e)};try{console.log("Sending fetch request for adding new product");let e=await fetch("https://fakestoreapi.com/products",r);if(!e.ok)throw new Error("Network error when adding new product");return console.log("Loading server response of adding new product"),await e.json()}catch(e){t("error","Error while adding new product "+e)}}(e);e.id=r.id;let n=o.findIndex((t=>t.id===e.id));-1===n&&(n=o.length),o[n]=e,c("category",a),t("success",`New product <strong>${e.title}</strong> added.`)}catch(e){t("error",e)}})(n),r.newProductName.value="",r.newProductCategory.value="",r.newProductPrice.value="",r.newProductImage.value="",w.style="display:none"})),f.addEventListener("click",(e=>{e.preventDefault();const t=document.forms.newProduct;t.newProductName.value="",t.newProductCategory.value="",t.newProductPrice.value="",t.newProductImage.value="",w.style="display:none"}))})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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TUFDdkQsSUFBWG9JLElBQWNBLEVBQVF4RyxFQUFhUCxRQUV2Q08sRUFBYXdHLEdBQVNaLEVBQ3RCMUYsRUFBa0IsV0FBWUQsR0FFOUJoRCxFQUFZLFVBQVcsdUJBQXVCMkksRUFBZXRILHdCQUMvRCxDQUFFLE1BQU9rRCxHQUNQdkUsRUFBWSxRQUFTdUUsRUFDdkIsQ0FDRixFR25DRWtGLENBQWNkLEdBR2RILEVBQUtJLGVBQWV6RixNQUFRLEdBQzVCcUYsRUFBS0ssbUJBQW1CMUYsTUFBUSxHQUNoQ3FGLEVBQUtNLGdCQUFnQjNGLE1BQVEsR0FDN0JxRixFQUFLTyxnQkFBZ0I1RixNQUFRLEdBRzdCa0MsRUFBTWlELE1BQVEsY0FBYyxJQUc5QmxELEVBQW9CNUIsaUJBQWlCLFNBQVVDLElBQzdDQSxFQUFNOEUsaUJBQ04sTUFBTUMsRUFBT3BJLFNBQVNxSSxNQUFNQyxXQUc1QkYsRUFBS0ksZUFBZXpGLE1BQVEsR0FDNUJxRixFQUFLSyxtQkFBbUIxRixNQUFRLEdBQ2hDcUYsRUFBS00sZ0JBQWdCM0YsTUFBUSxHQUM3QnFGLEVBQUtPLGdCQUFnQjVGLE1BQVEsR0FHN0JrQyxFQUFNaUQsTUFBUSxjQUFjLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91cmJhbl9leDEwL3dlYnBhY2svYm9vdHN0cmFwIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9tZXNzYWdlL21lc3NhZ2UuanMiLCJ3ZWJwYWNrOi8vdXJiYW5fZXgxMC8uL3NyYy9tb2R1bGVzL3Byb2R1Y3RMaXN0L3Byb2R1Y3RDYXJkL3Byb2R1Y3RDYXJkLmpzIiwid2VicGFjazovL3VyYmFuX2V4MTAvd2VicGFjay9ydW50aW1lL2dsb2JhbCIsIndlYnBhY2s6Ly91cmJhbl9leDEwL3dlYnBhY2svcnVudGltZS9wdWJsaWNQYXRoIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9wcm9kdWN0TGlzdC9wcm9kdWN0TGlzdC5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL3NjcmlwdHMvZGF0YUxvYWRpbmcuanMiLCJ3ZWJwYWNrOi8vdXJiYW5fZXgxMC8uL3NyYy9tb2R1bGVzL2Zvb3Rlci9mb290ZXJMaW5rcy9mb290ZXJMaW5rcy5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL2luZGV4LmpzIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9IZWFkZXIvaGVhZGVyLmpzIiwid2VicGFjazovL3VyYmFuX2V4MTAvLi9zcmMvbW9kdWxlcy9wcm9kdWN0TGlzdC9jYXRlZ29yeUZpbHRlci9jYXRlZ29yeUZpbHRlci5qcyIsIndlYnBhY2s6Ly91cmJhbl9leDEwLy4vc3JjL21vZHVsZXMvZm9vdGVyL2Zvb3Rlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBUaGUgcmVxdWlyZSBzY29wZVxudmFyIF9fd2VicGFja19yZXF1aXJlX18gPSB7fTtcblxuIiwiaW1wb3J0IFwiLi9tZXNzYWdlLnNjc3NcIlxuXG5leHBvcnQgZnVuY3Rpb24gc2hvd01lc3NhZ2UodHlwZSwgdGV4dCkge1xuXG4gIGNvbnN0IG1lc3NhZ2VDb250YWluZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIm1lc3NhZ2VDb250YWluZXJcIik7XG4gIC8vdHlwZSAtIHN1Y2Nlc3MsIGZhaWwsIHdhcm5pbmc7XG4gIGxldCBtZXNzYWdlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgbWVzc2FnZS5jbGFzc05hbWUgPSBgbWVzc2FnZV9fZWxlbWVudCAke3R5cGV9YDtcbiAgbWVzc2FnZS5pbm5lckhUTUwgPSB0ZXh0O1xuXG4gIG1lc3NhZ2VDb250YWluZXIuYXBwZW5kKG1lc3NhZ2UpO1xuXG4gIHNldFRpbWVvdXQoKCkgPT4gbWVzc2FnZS5yZW1vdmUoKSwgNTAwMCk7XG5cbn1cbiIsImltcG9ydCAnLi9wcm9kdWN0Q2FyZC5zY3NzJ1xuXG5leHBvcnQgZnVuY3Rpb24gc2hvd1Byb2R1Y3RDYXJkKHByb2R1Y3REYXRhLCBwYXJlbnQpIHtcblxuICBsZXQgcHJvZHVjdENhcmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBwcm9kdWN0Q2FyZC5jbGFzc05hbWUgPSAncHJvZHVjdENhcmQnO1xuICBwcm9kdWN0Q2FyZC5kYXRhc2V0LnByb2R1Y3RJZCA9IHByb2R1Y3REYXRhLmlkO1xuXG4gIHByb2R1Y3RDYXJkLmlubmVySFRNTCA9IGA8YnV0dG9uIGNsYXNzPVwiYnRuIGJ0bi0tZGVsZXRlXCI+RGVsZXRlIHByb2R1Y3Q8L2J1dHRvbj5cbiAgICA8ZGl2IGNsYXNzPVwicHJvZHVjdENhcmRfX2ltZ0NvbnRhaW5lclwiPlxuICAgICAgPGltZyBjbGFzcz1cInByb2R1Y3RDYXJkX19pbWdcIiBzcmM9XCIke3Byb2R1Y3REYXRhLmltYWdlfVwiIGFsdD1cImltYWdlXCI+XG5cbiAgICA8L2Rpdj5cbiAgICA8ZGl2IGNsYXNzPVwicHJvZHVjdENhcmRfX2luZm9cIj5cbiAgICAgIDxoMyBjbGFzcz1cInByb2R1Y3RDYXJkX190aXRsZVwiPiR7cHJvZHVjdERhdGEudGl0bGV9PC9oMz5cbiAgICAgIDxwIGNsYXNzPVwicHJvZHVjdENhcmRfX2NhdGVnb3J5XCI+JHtwcm9kdWN0RGF0YS5jYXRlZ29yeX08L3A+XG4gICAgICA8cCBjbGFzcz1cInByb2R1Y3RDYXJkX19wcmljZVwiPiR7cHJvZHVjdERhdGEucHJpY2V9PC9wPlxuICAgIDwvZGl2PmA7XG5cbiAgcGFyZW50LmFwcGVuZENoaWxkKHByb2R1Y3RDYXJkKTtcblxufVxuXG4iLCJfX3dlYnBhY2tfcmVxdWlyZV9fLmcgPSAoZnVuY3Rpb24oKSB7XG5cdGlmICh0eXBlb2YgZ2xvYmFsVGhpcyA9PT0gJ29iamVjdCcpIHJldHVybiBnbG9iYWxUaGlzO1xuXHR0cnkge1xuXHRcdHJldHVybiB0aGlzIHx8IG5ldyBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpO1xuXHR9IGNhdGNoIChlKSB7XG5cdFx0aWYgKHR5cGVvZiB3aW5kb3cgPT09ICdvYmplY3QnKSByZXR1cm4gd2luZG93O1xuXHR9XG59KSgpOyIsInZhciBzY3JpcHRVcmw7XG5pZiAoX193ZWJwYWNrX3JlcXVpcmVfXy5nLmltcG9ydFNjcmlwdHMpIHNjcmlwdFVybCA9IF9fd2VicGFja19yZXF1aXJlX18uZy5sb2NhdGlvbiArIFwiXCI7XG52YXIgZG9jdW1lbnQgPSBfX3dlYnBhY2tfcmVxdWlyZV9fLmcuZG9jdW1lbnQ7XG5pZiAoIXNjcmlwdFVybCAmJiBkb2N1bWVudCkge1xuXHRpZiAoZG9jdW1lbnQuY3VycmVudFNjcmlwdCAmJiBkb2N1bWVudC5jdXJyZW50U2NyaXB0LnRhZ05hbWUudG9VcHBlckNhc2UoKSA9PT0gJ1NDUklQVCcpXG5cdFx0c2NyaXB0VXJsID0gZG9jdW1lbnQuY3VycmVudFNjcmlwdC5zcmM7XG5cdGlmICghc2NyaXB0VXJsKSB7XG5cdFx0dmFyIHNjcmlwdHMgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNjcmlwdFwiKTtcblx0XHRpZihzY3JpcHRzLmxlbmd0aCkge1xuXHRcdFx0dmFyIGkgPSBzY3JpcHRzLmxlbmd0aCAtIDE7XG5cdFx0XHR3aGlsZSAoaSA+IC0xICYmICghc2NyaXB0VXJsIHx8ICEvXmh0dHAocz8pOi8udGVzdChzY3JpcHRVcmwpKSkgc2NyaXB0VXJsID0gc2NyaXB0c1tpLS1dLnNyYztcblx0XHR9XG5cdH1cbn1cbi8vIFdoZW4gc3VwcG9ydGluZyBicm93c2VycyB3aGVyZSBhbiBhdXRvbWF0aWMgcHVibGljUGF0aCBpcyBub3Qgc3VwcG9ydGVkIHlvdSBtdXN0IHNwZWNpZnkgYW4gb3V0cHV0LnB1YmxpY1BhdGggbWFudWFsbHkgdmlhIGNvbmZpZ3VyYXRpb25cbi8vIG9yIHBhc3MgYW4gZW1wdHkgc3RyaW5nIChcIlwiKSBhbmQgc2V0IHRoZSBfX3dlYnBhY2tfcHVibGljX3BhdGhfXyB2YXJpYWJsZSBmcm9tIHlvdXIgY29kZSB0byB1c2UgeW91ciBvd24gbG9naWMuXG5pZiAoIXNjcmlwdFVybCkgdGhyb3cgbmV3IEVycm9yKFwiQXV0b21hdGljIHB1YmxpY1BhdGggaXMgbm90IHN1cHBvcnRlZCBpbiB0aGlzIGJyb3dzZXJcIik7XG5zY3JpcHRVcmwgPSBzY3JpcHRVcmwucmVwbGFjZSgvIy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcPy4qJC8sIFwiXCIpLnJlcGxhY2UoL1xcL1teXFwvXSskLywgXCIvXCIpO1xuX193ZWJwYWNrX3JlcXVpcmVfXy5wID0gc2NyaXB0VXJsOyIsImltcG9ydCB7IGRlbGV0ZVByb2R1Y3QsIGxvYWRQcm9kdWN0cywgbG9hZFNpbmdsZVByb2R1Y3QsIGFkZFByb2R1Y3QgfSBmcm9tIFwiQC9zY3JpcHRzL2RhdGFMb2FkaW5nLmpzXCI7XG5pbXBvcnQgeyBzZXRDYXRlZ29yeVNlbGVjdCB9IGZyb20gXCJAL21vZHVsZXMvcHJvZHVjdExpc3QvY2F0ZWdvcnlGaWx0ZXIvY2F0ZWdvcnlGaWx0ZXIuanNcIjtcbmltcG9ydCB7IHNob3dQcm9kdWN0Q2FyZCB9IGZyb20gXCJAL21vZHVsZXMvcHJvZHVjdExpc3QvL3Byb2R1Y3RDYXJkL3Byb2R1Y3RDYXJkLmpzXCI7XG5pbXBvcnQgJ0AvbW9kdWxlcy9wcm9kdWN0TGlzdC8vcHJvZHVjdExpc3Quc2Nzcyc7XG5pbXBvcnQgeyBzaG93TWVzc2FnZSB9IGZyb20gXCJAL21vZHVsZXMvbWVzc2FnZS9tZXNzYWdlLmpzXCI7XG5cbmNvbnN0IHByb2R1Y3RMaXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJwcm9kdWN0LWxpc3RcIik7XG5cbmxldCBwcm9kdWN0c0RhdGEgPSBbXTtcbmxldCBjYXRlZ29yeUZpbHRlciA9ICcnO1xuXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbml0UHJvZHVjdExpc3QoKSB7XG4gIHRyeSB7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGxvYWRQcm9kdWN0cyg2KTtcbiAgICBjb25zb2xlLmxvZyhyZXN1bHQpO1xuXG4gICAgcmVzdWx0LmZvckVhY2gocHJvZCA9PiB7XG4gICAgICBzaG93UHJvZHVjdENhcmQocHJvZCwgcHJvZHVjdExpc3QpO1xuICAgICAgcHJvZHVjdHNEYXRhLnB1c2gocHJvZCk7XG4gICAgfSk7XG4gICAgc2V0Q2F0ZWdvcnlTZWxlY3QocHJvZHVjdExpc3QpO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHNob3dNZXNzYWdlKFwiZXJyb3JcIiwgXCJlcnJvciBsb2FkaW5nIGRhdGEgZnJvbSBBUEkgXCIgKyBlcnJvcik7XG4gIH1cblxufVxuXG5leHBvcnQgZnVuY3Rpb24gbG9hZE1vcmVQcm9kdWN0cyhidG4pIHtcblxuICBjb25zb2xlLmxvZyhcImxvYWQgbW9yZSBwcm9kdWN0cyBjYWxsZWRcIik7XG5cbiAgaWYgKHByb2R1Y3RzRGF0YS5sZW5ndGggPj0gMjApIHJldHVybjtcblxuICBjb25zdCBsb2FkQ291bnQgPSBNYXRoLm1pbig2LCAyMCAtIHByb2R1Y3RzRGF0YS5sZW5ndGgpO1xuICBsZXQgcHJvZHVjdElkQXJyID0gbmV3IEFycmF5KGxvYWRDb3VudCkuZmlsbCgpXG4gICAgLm1hcCgoXywgaSkgPT4gcHJvZHVjdHNEYXRhLmxlbmd0aCArIGkgKyAxKTtcblxuICBQcm9taXNlLmFsbFNldHRsZWQocHJvZHVjdElkQXJyLm1hcChpZCA9PiBsb2FkU2luZ2xlUHJvZHVjdChpZCkpKVxuICAgIC50aGVuKHJlc3VsdHMgPT4ge1xuICAgICAgcmVzdWx0cy5mb3JFYWNoKChwcm9kdWN0RGF0YSkgPT4ge1xuICAgICAgICBpZiAoIXByb2R1Y3REYXRhID8/IHByb2R1Y3REYXRhLnN0YXR1cyAhPT0gJ2Z1bGZpbGxlZCcpIHJldHVybjtcblxuICAgICAgICBwcm9kdWN0c0RhdGEucHVzaChwcm9kdWN0RGF0YS52YWx1ZSk7XG5cbiAgICAgIH0pO1xuXG4gICAgICBmaWx0ZXJQcm9kdWN0TGlzdChcImNhdGVnb3J5XCIsIGNhdGVnb3J5RmlsdGVyKVxuXG4gICAgICBpZiAocHJvZHVjdHNEYXRhLmxlbmd0aCA8IDIwKSB7XG4gICAgICAgIGJ0bi5yZW1vdmVBdHRyaWJ1dGUoJ2Rpc2FibGVkJyk7XG4gICAgICAgIGJ0bi5pbm5lckhUTUwgPSBcIkxvYWQgbW9yZVwiO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgYnRuLmlubmVySFRNTCA9IFwiTm8gZGF0YSBmb3IgbG9hZGluZ1wiO1xuICAgICAgfVxuICAgIH0pLmNhdGNoKGVycm9yID0+IHNob3dNZXNzYWdlKFwiZXJyb3JcIiwgZXJyb3IpKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbHRlclByb2R1Y3RMaXN0KGZpbHRlckJ5LCB2YWx1ZSkge1xuICBsZXQgZmlsdGVyZWRQcm9kdWN0cztcbiAgcHJvZHVjdExpc3QuaW5uZXJIVE1MID0gJyc7XG4gIGNhdGVnb3J5RmlsdGVyID0gdmFsdWU7XG5cbiAgaWYgKHZhbHVlICE9PSAnJykge1xuICAgIGZpbHRlcmVkUHJvZHVjdHMgPSBwcm9kdWN0c0RhdGEuZmlsdGVyKHByb2QgPT4gcHJvZFtmaWx0ZXJCeV0gPT09IHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICBmaWx0ZXJlZFByb2R1Y3RzID0gcHJvZHVjdHNEYXRhO1xuICB9XG5cbiAgZmlsdGVyZWRQcm9kdWN0cy5mb3JFYWNoKHByb2QgPT4gc2hvd1Byb2R1Y3RDYXJkKHByb2QsIHByb2R1Y3RMaXN0KSk7XG5cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGFkZE5ld1Byb2R1Y3QobmV3UHJvZHVjdERhdGEpIHtcblxuICB0cnkge1xuICAgIGxldCByZXNwb25zZSA9IGF3YWl0IGFkZFByb2R1Y3QobmV3UHJvZHVjdERhdGEpO1xuICAgIG5ld1Byb2R1Y3REYXRhLmlkID0gcmVzcG9uc2UuaWQ7XG4gICAgbGV0IGluZGV4ID0gcHJvZHVjdHNEYXRhLmZpbmRJbmRleChwcm9kID0+IHByb2QuaWQgPT09IG5ld1Byb2R1Y3REYXRhLmlkKTtcbiAgICBpZiAoaW5kZXggPT09IC0xKSBpbmRleCA9IHByb2R1Y3RzRGF0YS5sZW5ndGg7XG5cbiAgICBwcm9kdWN0c0RhdGFbaW5kZXhdID0gbmV3UHJvZHVjdERhdGE7XG4gICAgZmlsdGVyUHJvZHVjdExpc3QoXCJjYXRlZ29yeVwiLCBjYXRlZ29yeUZpbHRlcik7XG5cbiAgICBzaG93TWVzc2FnZShcInN1Y2Nlc3NcIiwgYE5ldyBwcm9kdWN0IDxzdHJvbmc+JHtuZXdQcm9kdWN0RGF0YS50aXRsZX08L3N0cm9uZz4gYWRkZWQuYCk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgc2hvd01lc3NhZ2UoXCJlcnJvclwiLCBlcnJvcik7XG4gIH1cbn1cblxucHJvZHVjdExpc3QuYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsIGV2ZW50ID0+IHtcbiAgaWYgKGV2ZW50LnRhcmdldC5pbm5lckhUTUwgPT09IFwiRGVsZXRlIHByb2R1Y3RcIikge1xuICAgIGxldCBwcm9kSWQgPSBldmVudC50YXJnZXQucGFyZW50Tm9kZS5kYXRhc2V0LnByb2R1Y3RJZDtcbiAgICBkZWxldGVQcm9kdWN0KHByb2RJZCkudGhlbihyZXN1bHQgPT4ge1xuICAgICAgaWYgKHJlc3VsdD8uaWQgPT0gcHJvZElkKSB7XG4gICAgICAgIGV2ZW50LnRhcmdldC5wYXJlbnROb2RlLnJlbW92ZSgpO1xuICAgICAgfVxuICAgIH0pXG4gIH1cbn0pXG5cbiIsImltcG9ydCB7IHNob3dNZXNzYWdlIH0gZnJvbSBcIkAvbW9kdWxlcy9tZXNzYWdlL21lc3NhZ2UuanNcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxvYWRQcm9kdWN0cyhsaW1pdCkge1xuICBsZXQgdXJsID0gJ2h0dHBzOi8vZmFrZXN0b3JlYXBpLmNvbS9wcm9kdWN0cyc7XG5cbiAgaWYgKCFpc05hTigrbGltaXQpKSB7XG4gICAgdXJsID0gdXJsICsgYD9saW1pdD0ke2xpbWl0fWA7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyBmZXRjaCByZXF1ZXN0XCIpO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoXCJOZXR3b3JrIGVycm9yXCIpO1xuICAgIGNvbnNvbGUubG9nKFwibG9hZGluZyBkYXRhIHByb2R1Y3QgZGF0YVwiKTtcbiAgICBsZXQgdmFsdWUgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuICAgIGNvbnNvbGUubG9nKFwiUHJvZHVjdCBkYXRhIGxvYWRlZC4gXCIsIHZhbHVlKTtcbiAgICByZXR1cm4gdmFsdWU7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBzaG93TWVzc2FnZShcImVycm9yXCIsIFwiRXJyb3IgbG9hZGluZyBwcm9kdWN0cyBcIiArIGVycm9yKTtcbiAgfVxufVxuXG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2FkU2luZ2xlUHJvZHVjdChwcm9kdWN0SWQpIHtcbiAgbGV0IHVybCA9IGBodHRwczovL2Zha2VzdG9yZWFwaS5jb20vcHJvZHVjdHMvJHtwcm9kdWN0SWR9YDtcblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyBmZXRjaCByZXF1ZXN0XCIpO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwpO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoJ05ldHdvcmsgcHJvYmxlbS4gJyk7XG5cbiAgICBjb25zb2xlLmxvZyhcImxvYWRpbmcgcHJvZHVjdCBkYXRhXCIpO1xuICAgIGxldCB2YWx1ZSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2coXCJQcm9kdWN0IGRhdGEgbG9hZGVkLiBcIiwgdmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHNob3dNZXNzYWdlKFwiZXJyb3JcIiwgXCJFcnJvciBsb2FkaW5nIHByb2R1Y3RzIGRhdGEgXCIgKyBlcnJvcik7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZVByb2R1Y3QocHJvZHVjdElkKSB7XG4gIGxldCB1cmwgPSBgaHR0cHM6Ly9mYWtlc3RvcmVhcGkuY29tL3Byb2R1Y3RzLyR7cHJvZHVjdElkfWA7XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhgU2VuZGluZyBmZXRjaCByZXF1ZXN0IGZvciBkZWxldGluZyBwcm9kdWN0ICR7cHJvZHVjdElkfWApO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwsIHsgbWV0aG9kOiAnREVMRVRFJyB9KTtcbiAgICBpZiAoIXJlc3VsdC5vaykgdGhyb3cgbmV3IEVycm9yKCdOZXR3b3JrIHByb2JsZW0gd2hlbiBkZWxldGluZyBwcm9kdWN0Jyk7XG5cbiAgICBsZXQgdmFsdWUgPSBhd2FpdCByZXN1bHQuanNvbigpO1xuXG4gICAgaWYgKHZhbHVlID09PSBudWxsKSB7XG4gICAgICBjb25zb2xlLmRpcih2YWx1ZSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBwcm9kdWN0IGluIGRhdGFiYXNlXCIpO1xuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKHZhbHVlLmlkLCBwcm9kdWN0SWQpO1xuICAgIGlmICh2YWx1ZS5pZCA9PSBwcm9kdWN0SWQpIHtcblxuICAgICAgc2hvd01lc3NhZ2UoXCJzdWNjZXNzXCIsIGBQcm9kdWN0OiAke3ZhbHVlLnRpdGxlfSBzdWNjZXNzZnVsbHkgZGVsZXRlZCBmcm9tIGRhdGFiYXNlYCk7XG4gICAgfVxuXG4gICAgY29uc29sZS5sb2coYFJlY2VpdmVkIHJlc3VsdCBvZiBkZWxldGluZyBwcm9kdWN0ICR7dmFsdWUudGl0bGV9YCk7XG4gICAgY29uc29sZS5kaXIodmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHNob3dNZXNzYWdlKFwiZXJyb3JcIiwgXCJFcnJvciBkZWxldGluZyBwcm9kdWN0IFwiICsgZXJyb3IpO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBhZGRQcm9kdWN0KHByb2R1Y3REYXRhKSB7XG4gIGNvbnN0IHVybCA9ICdodHRwczovL2Zha2VzdG9yZWFwaS5jb20vcHJvZHVjdHMnO1xuICBjb25zdCBvcHRpb25zID0ge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogSlNPTi5zdHJpbmdpZnkocHJvZHVjdERhdGEpXG4gIH07XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZyhcIlNlbmRpbmcgZmV0Y2ggcmVxdWVzdCBmb3IgYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuICAgIGxldCByZXN1bHQgPSBhd2FpdCBmZXRjaCh1cmwsIG9wdGlvbnMpO1xuICAgIGlmICghcmVzdWx0Lm9rKSB0aHJvdyBuZXcgRXJyb3IoXCJOZXR3b3JrIGVycm9yIHdoZW4gYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBzZXJ2ZXIgcmVzcG9uc2Ugb2YgYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuXG4gICAgbGV0IHZhbHVlID0gYXdhaXQgcmVzdWx0Lmpzb24oKTtcblxuICAgIC8vY29uc29sZS5sb2coXCJSZXN1bHQgb2YgYWRkaW5nIG5ldyBwcm9kdWN0XCIpO1xuICAgIC8vY29uc29sZS5kaXIodmFsdWUpO1xuXG4gICAgcmV0dXJuIHZhbHVlO1xuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgc2hvd01lc3NhZ2UoXCJlcnJvclwiLCBcIkVycm9yIHdoaWxlIGFkZGluZyBuZXcgcHJvZHVjdCBcIiArIGVycm9yKTtcbiAgfVxufVxuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0Q2F0ZWdvcmllcygpIHtcbiAgY29uc3QgdXJsID0gJ2h0dHBzOi8vZmFrZXN0b3JlYXBpLmNvbS9wcm9kdWN0cy9jYXRlZ29yaWVzJztcblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKFwiU2VuZGluZyBmZXRjaCByZXF1ZXN0IGZvciBsb2FkIGNhdGVnb3JpZXNcIik7XG4gICAgbGV0IHJlc3VsdCA9IGF3YWl0IGZldGNoKHVybCk7XG4gICAgaWYgKCFyZXN1bHQub2spIHRocm93IG5ldyBFcnJvcignTmV0d29yayBlcnJvciB3aGlsZSBsb2FkaW5nIGNhdGVnb3JpZXMnKTtcblxuICAgIGNvbnNvbGUubG9nKFwiTG9hZGluZyBjYXRlZ29yaWVzIG5hbWVzXCIpO1xuICAgIGxldCB2YWx1ZSA9IGF3YWl0IHJlc3VsdC5qc29uKCk7XG4gICAgY29uc29sZS5sb2codmFsdWUpO1xuICAgIHJldHVybiB2YWx1ZTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHNob3dNZXNzYWdlKFwiZXJyb3JcIiwgXCJFcnJvciBsb2FkaW5nIGNhdGVnb3JpZXMgXCIgKyBlcnJvcik7XG4gIH1cbn1cbiIsImltcG9ydCAnLi9mb290ZXJMaW5rcy5zY3NzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNldEZvb3RlckxpbmtzKGxpbmtzVGl0bGUsIGxpbmtzQXJyKSB7XG5cbiAgaWYgKCFsaW5rc1RpdGxlIHx8ICFsaW5rc0FycikgcmV0dXJuIG51bGw7XG5cbiAgbGV0IGxpbmtzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInVsXCIpO1xuICBsaW5rcy5jbGFzc05hbWUgPSBcImZvb3Rlcl9fbGlua3NcIjtcbiAgbGlua3MuaW5uZXJIVE1MID0gYDxsaT48aDM+JHtsaW5rc1RpdGxlfTwvaDM+PC9saT5gO1xuXG4gIGxpbmtzQXJyLmZvckVhY2gobGluayA9PiB7XG4gICAgbGlua3MuaW5uZXJIVE1MID0gbGlua3MuaW5uZXJIVE1MICtcbiAgICAgIGA8bGk+XG4gICAgICAgIDxhIGhyZWY9XCIke2xpbmsuaHJlZn1cIj4ke2xpbmsubmFtZX08L2E+XG4gICAgICA8L2xpPmA7XG4gIH0pO1xuXG4gIHJldHVybiBsaW5rcztcbn1cbiIsIi8vaW1wb3J0IHsgc2hvd1Byb2R1Y3RDYXJkIH0gZnJvbSBcIi4vbW9kdWxlcy9wcm9kdWN0Q2FyZC9wcm9kdWN0Q2FyZC5qc1wiO1xuaW1wb3J0IHsgaW5pdFByb2R1Y3RMaXN0LCBsb2FkTW9yZVByb2R1Y3RzLCBzZXRDYXRlZ29yeVNlbGVjdCwgYWRkTmV3UHJvZHVjdCB9IGZyb20gXCJAL21vZHVsZXMvcHJvZHVjdExpc3QvcHJvZHVjdExpc3QuanNcIjtcbmltcG9ydCB7IGFkZFByb2R1Y3QsIGRlbGV0ZVByb2R1Y3QsIGdldENhdGVnb3JpZXMgfSBmcm9tIFwiQC9zY3JpcHRzL2RhdGFMb2FkaW5nLmpzXCI7XG4vL2ltcG9ydCB7IGxvYWRQcm9kdWN0cyB9IGZyb20gXCIuL3NjcmlwdHMvZGF0YUxvYWRpbmcuanNcIjtcbmltcG9ydCBcIkAvc3R5bGVzL21haW4uc2Nzc1wiO1xuaW1wb3J0IHsgc2hvd0hlYWRlciB9IGZyb20gXCJAL21vZHVsZXMvSGVhZGVyL2hlYWRlci5qc1wiO1xuaW1wb3J0IHsgc2hvd0Zvb3RlciB9IGZyb20gXCJAL21vZHVsZXMvZm9vdGVyL2Zvb3Rlci5qc1wiO1xuaW1wb3J0IHsgc2hvd01lc3NhZ2UgfSBmcm9tIFwiQC9tb2R1bGVzL21lc3NhZ2UvbWVzc2FnZVwiO1xuXG5cbmNvbnN0IGJ0bkxvYWRNb3JlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2xvYWRNb3JlUHJvZHVjdHMnKTtcbmNvbnN0IGJ0bkFkZFByb2R1Y3QgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnRuQWRkUHJvZHVjdCcpO1xuY29uc3QgYnRuQWRkTmV3UHJvZHVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG5BZGROZXdQcm9kdWN0Jyk7XG5jb25zdCBidG5DYW5jZWxOZXdQcm9kdWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2J0bkNhbmNlbE5ld1Byb2R1Y3QnKTtcblxuY29uc3QgcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXAnKTtcblxuXG5zaG93SGVhZGVyKCk7XG5cbmluaXRQcm9kdWN0TGlzdCgpO1xuLy9nZXRDYXRlZ29yaWVzKCk7XG5zaG93Rm9vdGVyKCk7XG5cbmJ0bkxvYWRNb3JlLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgbG9hZE1vcmVQcm9kdWN0cyhldmVudC50YXJnZXQpO1xuICBldmVudC50YXJnZXQuc2V0QXR0cmlidXRlKCdkaXNhYmxlZCcsICcnKTtcbiAgZXZlbnQudGFyZ2V0LnRleHRDb250ZW50ID0gJ0xvYWRpbmcuLi4nO1xufSk7XG5cblxuYnRuQWRkUHJvZHVjdC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cC5zdHlsZSA9IFwiXCI7XG59KVxuXG5idG5BZGROZXdQcm9kdWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmZvcm1zLm5ld1Byb2R1Y3Q7XG5cbiAgY29uc3QgbmV3UHJvZHVjdERhdGEgPSB7XG4gICAgdGl0bGU6IGZvcm0ubmV3UHJvZHVjdE5hbWUudmFsdWUsXG4gICAgY2F0ZWdvcnk6IGZvcm0ubmV3UHJvZHVjdENhdGVnb3J5LnZhbHVlLFxuICAgIHByaWNlOiBmb3JtLm5ld1Byb2R1Y3RQcmljZS52YWx1ZSxcbiAgICBpbWFnZTogZm9ybS5uZXdQcm9kdWN0SW1hZ2UudmFsdWVcbiAgfVxuXG4gIGZvciAobGV0IHByb3AgaW4gbmV3UHJvZHVjdERhdGEpIHtcbiAgICBpZiAobmV3UHJvZHVjdERhdGFbcHJvcF0gPT09IFwiXCIpIHtcbiAgICAgIGFsZXJ0KFwi0JLRgdC1INC/0L7Qu9GPINGE0L7RgNC80Ysg0LTQvtC70LbQvdGLINCx0YvRgtGMINC30LDQv9C+0LvQvdC10L3Ri1wiKTtcbiAgICAgIHJldHVyblxuICAgIH1cbiAgfVxuXG4gIGFkZE5ld1Byb2R1Y3QobmV3UHJvZHVjdERhdGEpO1xuXG4gIC8vY2xlYXIgZm9ybVxuICBmb3JtLm5ld1Byb2R1Y3ROYW1lLnZhbHVlID0gXCJcIjtcbiAgZm9ybS5uZXdQcm9kdWN0Q2F0ZWdvcnkudmFsdWUgPSBcIlwiO1xuICBmb3JtLm5ld1Byb2R1Y3RQcmljZS52YWx1ZSA9IFwiXCI7XG4gIGZvcm0ubmV3UHJvZHVjdEltYWdlLnZhbHVlID0gXCJcIjtcblxuICAvL2hpZGUgcG9wdXAsXG4gIHBvcHVwLnN0eWxlID0gXCJkaXNwbGF5Om5vbmVcIjtcbn0pO1xuXG5idG5DYW5jZWxOZXdQcm9kdWN0LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoZXZlbnQpID0+IHtcbiAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgY29uc3QgZm9ybSA9IGRvY3VtZW50LmZvcm1zLm5ld1Byb2R1Y3Q7XG5cbiAgLy9jbGVhciBmb3JtXG4gIGZvcm0ubmV3UHJvZHVjdE5hbWUudmFsdWUgPSBcIlwiO1xuICBmb3JtLm5ld1Byb2R1Y3RDYXRlZ29yeS52YWx1ZSA9IFwiXCI7XG4gIGZvcm0ubmV3UHJvZHVjdFByaWNlLnZhbHVlID0gXCJcIjtcbiAgZm9ybS5uZXdQcm9kdWN0SW1hZ2UudmFsdWUgPSBcIlwiO1xuXG4gIC8vaGlkZSBwb3B1cCwgY2xlYXIgZm9ybTtcbiAgcG9wdXAuc3R5bGUgPSBcImRpc3BsYXk6bm9uZVwiO1xufSk7XG5cblxuXG5cblxuXG5cblxuXG4iLCJpbXBvcnQgJy4vaGVhZGVyLnNjc3MnO1xuaW1wb3J0IExvZ28gZnJvbSAnLi9Mb2dvS3Jpc3Quc3ZnJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dIZWFkZXIoKSB7XG4gIGNvbnN0IGhlYWRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJoZWFkZXJcIik7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBsb2dvRWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIC8vIGNvbnN0IGxvZ28gPSBuZXcgSW1hZ2UoKTtcbiAgY29uc3QgbmF2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm5hdlwiKTtcbiAgY29uc3QgbWVudSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJvZHlcIilbMF07XG4gIC8vY29uc29sZS5sb2coYm9keS5wcmVwZW5kKTtcblxuXG4gIGhlYWRlci5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcImhlYWRlclwiKTtcbiAgaGVhZGVyLmNsYXNzTmFtZSA9IFwiaGVhZGVyXCI7XG5cbiAgd3JhcHBlci5jbGFzc05hbWUgPSBcImhlYWRlcl9fY29udGVudFdyYXBwZXJcIjtcblxuICBsb2dvRWxlbS5jbGFzc05hbWUgPSBcImhlYWRlcl9fbG9nb1wiO1xuXG4gIGxvZ29FbGVtLmlubmVySFRNTCA9XG4gICAgYDxpbWcgc3JjPVwiJHtMb2dvfVwiIGFsdD1cImxvZ29cIj5gO1xuICAvKlxuICBsb2dvLnNyYyA9IExvZ287XG4gIGxvZ28uYWx0ID0gXCJsb2dvXCI7XG4gIGxvZ29FbGVtLmFwcGVuZENoaWxkKGxvZ28pOyovXG5cbiAgbmF2LmNsYXNzTmFtZSA9IFwiaGVhZGVyX19uYXZcIjtcbiAgbmF2LmlubmVySFRNTCA9XG4gICAgYDx1bD5cbiAgICAgICAgICA8bGk+SG9tZTwvbGk+XG4gICAgICAgICAgPGxpPlNob3A8L2xpPlxuICAgICAgICAgIDxsaT5PdXIgU3Rvcnk8L2xpPlxuICAgICAgICAgIDxsaT5CbG9nPC9saT5cbiAgICAgICAgICA8bGk+Q29udGFjdCBVczwvbGk+XG4gICAgICAgIDwvdWw+YDtcblxuXG4gIG1lbnUuY2xhc3NOYW1lID0gXCJoZWFkZXJfX21lbnVcIjtcbiAgbWVudS5pbm5lckhUTUwgPSBcIk1lbnUgaXRlbXNcIjtcblxuXG5cbiAgLy9UT0RPOiBhcHBlbmQgbG9nbyBmcm9tIG1vZHVsZVxuICAvL1RPRE86IGFwcGVuZCBuYXYgZnJvbSBtb2R1bGVcbiAgLy9UT0RPOiBhcHBlbmQgbWVudSBmcm9tIG1vZHVsZVxuXG4gIHdyYXBwZXIuYXBwZW5kKGxvZ29FbGVtLCBuYXYsIG1lbnUpO1xuICBoZWFkZXIuYXBwZW5kQ2hpbGQod3JhcHBlcik7XG5cbiAgYm9keS5wcmVwZW5kKGhlYWRlcik7XG4gIC8qXG5cbiAgaGVhZGVyLmlubmVySFRNTCA9IGA8ZGl2IGNsYXNzPVwiaGVhZGVyX19jb250ZW50V3JhcHBlclwiPlxuICAgICAgPGRpdiBjbGFzcz1cImhlYWRlcl9fbG9nb1wiPlxuICAgICAgICA8aW1nIHNyYz1cIi4uL3B1YmxpYy9pbWcvTG9nb0tyaXN0LnN2Z1wiIGFsdD1cIkxvZ29cIj5cbiAgICAgIDwvZGl2PlxuICAgICAgPG5hdiBjbGFzcz1cImhlYWRlcl9fbmF2XCI+XG4gICAgICAgIDx1bD5cbiAgICAgICAgICA8bGk+SG9tZTwvbGk+XG4gICAgICAgICAgPGxpPlNob3A8L2xpPlxuICAgICAgICAgIDxsaT5PdXIgU3Rvcnk8L2xpPlxuICAgICAgICAgIDxsaT5CbG9nPC9saT5cbiAgICAgICAgICA8bGk+Q29udGFjdCBVczwvbGk+XG4gICAgICAgIDwvdWw+XG4gICAgICA8L25hdj5cbiAgICAgIDxkaXYgY2xhc3M9XCJoZWFkZXJfX21lbnVcIj5NZW51IGl0ZW1zPC9kaXY+XG4gICAgPC9kaXY+YFxuKi9cbiAgcmV0dXJuIGhlYWRlcjtcbn1cbiIsImltcG9ydCB7IGdldENhdGVnb3JpZXMgfSBmcm9tIFwiQC9zY3JpcHRzL2RhdGFMb2FkaW5nXCI7XG5pbXBvcnQgeyBmaWx0ZXJQcm9kdWN0TGlzdCB9IGZyb20gXCIuLi9wcm9kdWN0TGlzdFwiO1xuaW1wb3J0IFwiLi9jYXRlZ29yeUZpbHRlci5zY3NzXCJcblxuXG5cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHNldENhdGVnb3J5U2VsZWN0KHBhcmVudEVsZW1lbnQpIHtcbiAgbGV0IGNhdGVnb3J5RmlsdGVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gIGNhdGVnb3J5RmlsdGVyLmNsYXNzTmFtZSA9ICdwcm9kdWN0TGlzdF9fY2F0ZWdvcmllcyc7XG4gIGNhdGVnb3J5RmlsdGVyLnNldEF0dHJpYnV0ZSgnaWQnLCAncHJvZHVjdExpc3RfX2NhdGVnb3JpZXMnKTtcblxuICBnZXRDYXRlZ29yaWVzKCkudGhlbih2YWx1ZSA9PiBzaG93Q2F0ZWdvcnlTZWxlY3QodmFsdWUsIGNhdGVnb3J5RmlsdGVyKSk7XG5cblxuICBwYXJlbnRFbGVtZW50LnBhcmVudE5vZGUucHJlcGVuZChjYXRlZ29yeUZpbHRlcik7XG4gIGNhdGVnb3J5RmlsdGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsXG4gICAgKGV2ZW50KSA9PiBmaWx0ZXJQcm9kdWN0TGlzdCgnY2F0ZWdvcnknLCBldmVudC50YXJnZXQudmFsdWUpKTtcblxufVxuXG5mdW5jdGlvbiBzaG93Q2F0ZWdvcnlTZWxlY3Qoc2VsZWN0RGF0YSwgZWxlbSkge1xuICBsZXQgY2F0ZWdvcmllcyA9ICc8b3B0aW9uIHZhbHVlPVwiXCI+LS1TaG93IGFsbCBwcm9kdWN0cy0tPC9vcHRpb24+JztcblxuICBzZWxlY3REYXRhLmZvckVhY2goY2F0ZWdvcnkgPT4ge1xuICAgIGNhdGVnb3JpZXMgPSBjYXRlZ29yaWVzICsgYDxvcHRpb24gdmFsdWU9XCIke2NhdGVnb3J5fVwiPlxuICAgICAgICAke2NhdGVnb3J5fVxuICAgICAgPC9vcHRpb24+YDtcbiAgfSk7XG5cbiAgbGV0IGNhdGVnb3J5U2VsZWN0ID0gYDxsYWJlbCBmb3I9XCJwcm9kdWN0TGlzdF9fc2VsZWN0XCI+XG4gICAgICBTaG93IHByb2R1Y3RzIGZpbHRlcmVkIGJ5IGNhdGVnb3J5OlxuICAgIDwvbGFiZWw+XG4gICAgPHNlbGVjdCBuYW1lPVwicHJvZHVjdExpc3RfX3NlbGVjdFwiIGlkPVwicHJvZHVjdExpc3RfX3NlbGVjdFwiPlxuICAgICAgJHtjYXRlZ29yaWVzfTtcbiAgICA8L3NlbGVjdD5gO1xuXG4gIGVsZW0uaW5uZXJIVE1MID0gY2F0ZWdvcnlTZWxlY3Q7XG5cbiAgLy9jb25zb2xlLmxvZyhjYXRlZ29yeVNlbGVjdCk7XG4gIC8vcHJvZHVjdExpc3QucGFyZW50Tm9kZS5wcmVwZW5kKGVsZW0pO1xuICAvKiBlbGVtLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsXG4gICAgIChldmVudCkgPT4gZmlsdGVyUHJvZHVjdExpc3QoJ2NhdGVnb3J5JywgZXZlbnQudGFyZ2V0LnZhbHVlKSk7Ki9cbn1cbiIsImltcG9ydCAnLi9mb290ZXIuc2Nzcyc7XG5pbXBvcnQgTG9nbyBmcm9tICcuL0xvZ29LcmlzdC5zdmcnO1xuaW1wb3J0IEVudmVsb3BlIGZyb20gJy4vaWNvbnMvZW52ZWxvcGUuc3ZnJztcbmltcG9ydCBQaG9uZSBmcm9tICcuL2ljb25zL3Bob25lLnN2Zyc7XG5pbXBvcnQgUG9pbnRlciBmcm9tICcuL2ljb25zL3BvaW50ZXIuc3ZnJztcbmltcG9ydCB7IHNldEZvb3RlckxpbmtzIH0gZnJvbSAnLi9mb290ZXJMaW5rcy9mb290ZXJMaW5rcyc7XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHNob3dGb290ZXIoKSB7XG4gIGNvbnN0IGJvZHkgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImJvZHlcIilbMF07XG4gIGNvbnN0IGZvb3RlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb290ZXJcIik7XG4gIGNvbnN0IHdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICBjb25zdCBmb290ZXJDb250ZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgZm9vdGVyQm90dG9tID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgY29uc3QgZm9vdGVyQWRkcmVzcyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhZGRyZXNzXCIpO1xuICBjb25zdCBmb290ZXJTdWJzY3JpYmUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuXG4gIGZvb3RlckFkZHJlc3MuY2xhc3NOYW1lID0gXCJmb290ZXJfX2FkZHJlc3NcIlxuICBmb290ZXJBZGRyZXNzLmlubmVySFRNTCA9IGBcbiAgICA8cD5cbiAgICAgIDxpbWcgc3JjPSR7TG9nb30gYWx0PVwiTG9nb1wiIGNsYXNzPVwiZm9vdGVyX19sb2dvXCI+XG4gICAgPC9wPlxuICAgIDxwPlxuICAgICAgPGltZyBzcmM9JHtQaG9uZX0gYWx0PVwicGhvbmVcIiB3aWR0aD0yNCBoZWlnaHQ9MjQ+XG4gICAgICA8YSBocmVmPVwidGVsOisxIDcwNDU1NTAxMjdcIj4oNzA0KSA1NTUtMDEyNzwvYT5cbiAgICA8L3A+XG4gICAgPHA+XG4gICAgICA8aW1nIHNyYz0ke0VudmVsb3BlfSBhbHQ9XCJtYWlsXCIgd2lkdGg9MjQgaGVpZ2h0PTI0PlxuICAgICAgPGEgaHJlZj1cIm1haWx0bzprcmlzdEBleGFtcGxlLmNvbVwiPmtyaXN0QGV4YW1wbGUuY29tPC9hPlxuICAgIDwvcD5cbiAgICA8cD5cbiAgICAgIDxpbWcgc3JjPSR7UG9pbnRlcn0gYWx0PVwiYWRkcmVzc1wiIHdpZHRoPTI0IGhlaWdodD0yND5cbiAgICAgIDxzcGFuPjM4OTEgUmFuY2h2aWV3IERyLiBSaWNoYXJkc29uLCBDYWxpZm9ybmlhIDYyNjM5PC9zcGFuPlxuICAgIDwvcD5gO1xuICBmb290ZXJDb250ZW50LmNsYXNzTmFtZSA9IFwiZm9vdGVyX19jb250ZW50XCI7XG5cblxuICBjb25zdCBmb290ZXJJbmZvID0gc2V0Rm9vdGVyTGlua3MoXCJJbmZvcm1hdGlvblwiLCBbXG4gICAge1xuICAgICAgaHJlZjogXCIjXCIsXG4gICAgICBuYW1lOiBcIk15IEFjY291bnRcIlxuICAgIH0sXG4gICAge1xuICAgICAgaHJlZjogXCIjXCIsXG4gICAgICBuYW1lOiBcIkxvZ2luXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIGhyZWY6IFwiI1wiLFxuICAgICAgbmFtZTogXCJNeSBDYXJ0XCJcbiAgICB9LFxuICAgIHtcbiAgICAgIGhyZWY6IFwiI1wiLFxuICAgICAgbmFtZTogXCJNeSBXaXNobGlzdFwiXG4gICAgfSxcbiAgICB7XG4gICAgICBocmVmOiBcIiNcIixcbiAgICAgIG5hbWU6IFwiQ2hlY2tvdXRcIlxuICAgIH1cbiAgXSk7XG5cbiAgY29uc3QgZm9vdGVyU2VydmljZSA9IHNldEZvb3RlckxpbmtzKFwiU2VydmljZVwiLCBbXG4gICAge1xuICAgICAgaHJlZjogXCIjXCIsXG4gICAgICBuYW1lOiBcIkFib3V0IFVzXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIGhyZWY6IFwiI1wiLFxuICAgICAgbmFtZTogXCJDYXJlZXJzXCJcbiAgICB9LFxuICAgIHtcbiAgICAgIGhyZWY6IFwiI1wiLFxuICAgICAgbmFtZTogXCJEZWxpdmVyeSBJbmZvcm1hdGlvblwiXG4gICAgfSxcbiAgICB7XG4gICAgICBocmVmOiBcIiNcIixcbiAgICAgIG5hbWU6IFwiUHJpdmFjeSBQb2xpY3lcIlxuICAgIH0sXG4gICAge1xuICAgICAgaHJlZjogXCIjXCIsXG4gICAgICBuYW1lOiBcIlRlcm1zICYgQ29uZGl0aW9uc1wiXG4gICAgfVxuICBdKTtcblxuICBmb290ZXJTdWJzY3JpYmUuY2xhc3NOYW1lID0gXCJmb290ZXJfX3N1YnNjcmliZVwiXG4gIGZvb3RlclN1YnNjcmliZS5pbm5lckhUTUwgPSBgXG4gICAgPGgzPlN1YnNjcmliZTwvaDM+XG4gICAgPHA+RW50ZXIgeW91ciBlbWFpbCBiZWxvdyB0byBiZSB0aGUgZmlyc3QgdG8ga25vd1xuICAgICBhYm91dCBuZXcgY29sbGVjdGlvbnMgYW5kIHByb2R1Y3QgbGF1bmNoZXMuPC9wPlxuICAgICA8ZGl2IGNsYXNzPVwiZm9vdGVyX19zdWJzY3JpYmUtZW1haWxcIj5cbiAgICAgIDxpbWcgc3JjPVwiJHtFbnZlbG9wZX1cIiB3aWR0aD0yNCBoZWlnaHQ9MjQgYWx0PVwiZW52ZWxvcGVcIj5cbiAgICAgIDxpbnB1dCB0eXBlPVwidGV4dFwiIHBsYWNlaG9sZGVyPVwiWW91ciBFbWFpbFwiPlxuICAgICAgPHNwYW4+JiM4NTk0PC9zcGFuPlxuICAgICA8L2Rpdj5cblxuICBgO1xuXG4gIGZvb3RlckNvbnRlbnQuYXBwZW5kKGZvb3RlckFkZHJlc3MsIGZvb3RlckluZm8sIGZvb3RlclNlcnZpY2UsIGZvb3RlclN1YnNjcmliZSk7XG5cblxuICBmb290ZXIuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJmb290ZXJcIik7XG4gIGZvb3Rlci5jbGFzc05hbWUgPSBcImZvb3RlclwiO1xuXG5cbiAgd3JhcHBlci5jbGFzc05hbWUgPSBcImZvb3Rlcl9fd3JhcHBlclwiO1xuICB3cmFwcGVyLmFwcGVuZChmb290ZXJDb250ZW50LCBmb290ZXJCb3R0b20pO1xuICBmb290ZXIuYXBwZW5kKHdyYXBwZXIpO1xuXG4gIGJvZHkuYXBwZW5kKGZvb3Rlcik7XG5cblxuXG59XG4iXSwibmFtZXMiOlsiX193ZWJwYWNrX3JlcXVpcmVfXyIsInNob3dNZXNzYWdlIiwidHlwZSIsInRleHQiLCJtZXNzYWdlQ29udGFpbmVyIiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1lc3NhZ2UiLCJjcmVhdGVFbGVtZW50IiwiY2xhc3NOYW1lIiwiaW5uZXJIVE1MIiwiYXBwZW5kIiwic2V0VGltZW91dCIsInJlbW92ZSIsInNob3dQcm9kdWN0Q2FyZCIsInByb2R1Y3REYXRhIiwicGFyZW50IiwicHJvZHVjdENhcmQiLCJkYXRhc2V0IiwicHJvZHVjdElkIiwiaWQiLCJpbWFnZSIsInRpdGxlIiwiY2F0ZWdvcnkiLCJwcmljZSIsImFwcGVuZENoaWxkIiwiZyIsImdsb2JhbFRoaXMiLCJ0aGlzIiwiRnVuY3Rpb24iLCJlIiwid2luZG93Iiwic2NyaXB0VXJsIiwiaW1wb3J0U2NyaXB0cyIsImxvY2F0aW9uIiwiY3VycmVudFNjcmlwdCIsInRhZ05hbWUiLCJ0b1VwcGVyQ2FzZSIsInNyYyIsInNjcmlwdHMiLCJnZXRFbGVtZW50c0J5VGFnTmFtZSIsImxlbmd0aCIsImkiLCJ0ZXN0IiwiRXJyb3IiLCJyZXBsYWNlIiwicCIsInByb2R1Y3RMaXN0IiwicHJvZHVjdHNEYXRhIiwiY2F0ZWdvcnlGaWx0ZXIiLCJmaWx0ZXJQcm9kdWN0TGlzdCIsImZpbHRlckJ5IiwidmFsdWUiLCJmaWx0ZXJlZFByb2R1Y3RzIiwiZmlsdGVyIiwicHJvZCIsImZvckVhY2giLCJhZGRFdmVudExpc3RlbmVyIiwiZXZlbnQiLCJ0YXJnZXQiLCJwcm9kSWQiLCJwYXJlbnROb2RlIiwiYXN5bmMiLCJ1cmwiLCJjb25zb2xlIiwibG9nIiwicmVzdWx0IiwiZmV0Y2giLCJtZXRob2QiLCJvayIsImpzb24iLCJkaXIiLCJlcnJvciIsImRlbGV0ZVByb2R1Y3QiLCJ0aGVuIiwic2V0Rm9vdGVyTGlua3MiLCJsaW5rc1RpdGxlIiwibGlua3NBcnIiLCJsaW5rcyIsImxpbmsiLCJocmVmIiwibmFtZSIsImJ0bkxvYWRNb3JlIiwiYnRuQWRkUHJvZHVjdCIsImJ0bkFkZE5ld1Byb2R1Y3QiLCJidG5DYW5jZWxOZXdQcm9kdWN0IiwicG9wdXAiLCJxdWVyeVNlbGVjdG9yIiwiaGVhZGVyIiwid3JhcHBlciIsImxvZ29FbGVtIiwibmF2IiwibWVudSIsImJvZHkiLCJzZXRBdHRyaWJ1dGUiLCJwcmVwZW5kIiwic2hvd0hlYWRlciIsImlzTmFOIiwibG9hZFByb2R1Y3RzIiwicHVzaCIsInBhcmVudEVsZW1lbnQiLCJnZXRDYXRlZ29yaWVzIiwic2VsZWN0RGF0YSIsImVsZW0iLCJjYXRlZ29yaWVzIiwiY2F0ZWdvcnlTZWxlY3QiLCJzaG93Q2F0ZWdvcnlTZWxlY3QiLCJzZXRDYXRlZ29yeVNlbGVjdCIsImluaXRQcm9kdWN0TGlzdCIsImZvb3RlciIsImZvb3RlckNvbnRlbnQiLCJmb290ZXJCb3R0b20iLCJmb290ZXJBZGRyZXNzIiwiZm9vdGVyU3Vic2NyaWJlIiwiZm9vdGVySW5mbyIsImZvb3RlclNlcnZpY2UiLCJzaG93Rm9vdGVyIiwiYnRuIiwibG9hZENvdW50IiwiTWF0aCIsIm1pbiIsInByb2R1Y3RJZEFyciIsIkFycmF5IiwiZmlsbCIsIm1hcCIsIl8iLCJQcm9taXNlIiwiYWxsU2V0dGxlZCIsImxvYWRTaW5nbGVQcm9kdWN0IiwicmVzdWx0cyIsInN0YXR1cyIsInJlbW92ZUF0dHJpYnV0ZSIsImNhdGNoIiwibG9hZE1vcmVQcm9kdWN0cyIsInRleHRDb250ZW50Iiwic3R5bGUiLCJwcmV2ZW50RGVmYXVsdCIsImZvcm0iLCJmb3JtcyIsIm5ld1Byb2R1Y3QiLCJuZXdQcm9kdWN0RGF0YSIsIm5ld1Byb2R1Y3ROYW1lIiwibmV3UHJvZHVjdENhdGVnb3J5IiwibmV3UHJvZHVjdFByaWNlIiwibmV3UHJvZHVjdEltYWdlIiwicHJvcCIsImFsZXJ0IiwicmVzcG9uc2UiLCJvcHRpb25zIiwiSlNPTiIsInN0cmluZ2lmeSIsImFkZFByb2R1Y3QiLCJpbmRleCIsImZpbmRJbmRleCIsImFkZE5ld1Byb2R1Y3QiXSwic291cmNlUm9vdCI6IiJ9